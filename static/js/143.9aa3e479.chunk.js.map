{"version":3,"sources":["../node_modules/@arcgis/core/identity/IdentityForm.js","../../index.js","../../src/index.js","../node_modules/@arcgis/core/identity/IdentityModal.js","../node_modules/@arcgis/core/identity/OAuthCredential.js","../node_modules/@arcgis/core/identity/OAuthInfo.js","../node_modules/@arcgis/core/identity/ServerInfo.js","../node_modules/@arcgis/core/identity/IdentityManagerBase.js","../node_modules/@arcgis/core/identity/IdentityManager.js"],"names":["l","a","s","e","_usernameInputNode","_passwordInputNode","messages","signingIn","server","resource","error","oAuthPrompt","this","t","i","u","d","n","class","r","oAuthInfo","info","test","lblItem","c","lblUser","value","required","autocomplete","spellcheck","type","bind","afterCreate","o","m","lblPwd","h","classes","disabled","lblSigning","lblOk","lblCancel","onclick","_cancel","b","details","httpStatus","invalidUser","noAuthService","onsubmit","_submit","_set","emit","preventDefault","username","password","prototype","candidateSelectors","candidateSelector","matches","Element","getCandidates","candidates","Array","el","includeContainer","getTabindex","tabindexAttr","parseInt","node","isNaN","isContentEditable","sortOrderedTabbables","isInput","isNonTabbableRadio","isRadio","radioScope","queryRadios","name","window","radioSet","err","console","checked","nodes","getCheckedRadio","isTabbableRadio","isNodeMatchingSelectorFocusable","isHiddenInput","getComputedStyle","nodeUnderDetails","displayCheck","width","height","isHidden","options","child","isDetailsWithSummary","isNodeMatchingSelectorTabbable","focusableCandidateSelector","isFocusable","Error","activeFocusTraps","trapQueue","activateTrap","activeTrap","trapIndex","deactivateTrap","delay","setTimeout","fn","findIndex","idx","arr","valueOrHandler","params","createFocusTrap","doc","config","returnFocusOnDeactivate","escapeDeactivates","delayInitialFocus","state","containers","tabbableGroups","nodeFocusedBeforeActivation","mostRecentlyFocusedNode","active","paused","containersContain","container","getNodeForOption","optionValue","getInitialFocusNode","firstTabbableGroup","updateTabbableNodes","tabbableNodes","regularTabbables","orderedTabbables","candidate","candidateTabindex","documentOrder","tabIndex","tabbable","firstTabbableNode","lastTabbableNode","tryFocus","preventScroll","isSelectableInput","checkPointerDown","trap","returnFocus","checkFocusIn","targetContained","checkKey","isEscapeEvent","isTabEvent","destinationNode","startOfGroupIndex","destinationGroupIndex","lastOfGroupIndex","checkTab","checkClick","addListeners","activeFocusDelay","capture","passive","removeListeners","activate","onActivate","activateOptions","deactivate","clearTimeout","onDeactivate","deactivateOptions","pause","unpause","updateContainerElements","elementsAsArray","concat","containerElements","filter","element","document","createElement","content","open","_close","body","appendChild","own","watch","_toggleFocusTrap","_destroyFocusTrap","id","title","close","p","role","_createFocusTrap","_renderContent","_focusTrap","requestAnimationFrame","initialFocus","cancelAnimationFrame","innerHTML","render","HTMLElement","_attachToNode","readOnly","aliasOf","storage","appId","expires","ssl","token","userId","_init","Date","now","minTimeUntilExpiration","_load","authNamespace","portalUrl","setItem","JSON","stringify","log","replace","FormData","append","navigator","sendBeacon","XMLHttpRequest","send","_oAuthCred","getItem","parse","declaredClass","expiration","forceLogin","forceUserId","locale","popup","popupCallbackUrl","popupWindowFeatures","preserveUrlHash","fromJSON","toJSON","json","write","adminTokenServiceUrl","currentVersion","hasPortal","hasServer","owningSystemUrl","owningTenant","shortLivedTokenValidity","tokenServiceUrl","webTierAuth","R","host","P","some","C","D","localStorage","sessionStorage","j","_portalConfig","esriGeowConfig","serverInfos","oAuthInfos","credentials","_soReqs","_xoReqs","_portals","defaultOAuthInfo","defaultTokenValidity","dialog","formConstructor","y","tokenValidity","normalizeWebTierAuth","_appUrlObj","location","href","_busy","_rejectOnPersistedPageShow","_oAuthHash","_gwTokenUrl","_agsRest","_agsPortal","_agsAdmin","_adminSvcs","_gwDomains","regex","customBaseUrl","_legacyFed","_regexSDirUrl","_regexServerType","_gwUser","_gwItem","_gwGroup","_rePortalTokenSvc","_createDefaultOAuthInfo","_hasTestedIfAppIsOnPortal","_getOAuthHash","addEventListener","_pageShowHandler","findServerInfo","forEach","push","findOAuthInfo","splice","indexOf","_sanitizeUrl","_isServerRsrc","O","_getServerInstanceRoot","_getTokenSvcUrl","registerServers","_findCredential","Object","assign","q","scope","resources","emitTokenChange","refreshServerTokens","map","length","T","registerOAuthInfos","_hasSameServerInstance","_getIdenticalSvcIdx","prompt","v","signal","S","abort","reject","w","promise","_isAdminResource","findCredential","destroy","resolve","_restInfoPms","_selfReq","origin","selfDfd","_getPortalSelf","_enqueue","_isRESTService","_","f","g","toLowerCase","isAdmin","serverUrl","customParameters","scheme","uri","port","query","request","referer","client","method","authMode","useProxy","_useProxy","ioArgs","withCredentials","A","then","data","validity","checkAppAccess","credential","getCredential","_doPortalSignIn","force","client_id","valid","viewOnlyUserTypeApp","catch","viewOnly","_oAuthDfd","clearInterval","_oAuthIntervalId","_oAuthOnHashHandle","remove","charAt","substring","error_description","sinfo_","oinfo_","access_token","Number","expires_in","persist","save","_oAuthRedirectFunc","_protocolFunc","getResourceName","U","on","generateToken","oAuthWin_","closed","resUrl_","oAuthPopupConfirmation","_doOAuthSignIn","slice","_postMessageAuthHandle","endsWith","source","postMessage","message","hash","hasOwnProperty","persisted","isBusy","_errbackFunc","_addResource","_removeResource","_isIdProvider","_isPortalDomain","String","search","substr","_normalizeAGOLorgDomain","proxyUrl","path","_getSuffix","restBaseUrl","_isIdenticalService","adminUrl","_getOrigin","headers","Promise","allSSL","portalMode","supportsOAuth","protocol","trim","resourceUrl","serverInfo","options_","admin_","refresh_","focus","_doSignIn","creationTime","shift","_findOAuthInfo","parent","x","isValid","_pendingDfd","_exchangeToken","oAuthState","oAuthSignIn","_getPlatformSelf","_checkProtocol","signIn","user","portalToken","tokenExpiration","parseFloat","_generateOAuthInfo","accountId","redirect_uri","clone","urlKey","top","response_type","force_login","prepopulatedusername","redirectToUserOrgUrl","setInterval","setOAuthResponseHash","detail","authorizeParams","authorizeUrl","I","tokenRefreshBuffer","k","_enqueued","refreshToken","_refreshTimer","_startRefreshTimer","EventedAccessor"],"mappings":"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","file":"static/js/143.9aa3e479.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as s}from\"../chunks/tslib.es6.js\";import\"../core/has.js\";import\"../core/Logger.js\";import\"../core/accessorSupport/ensureType.js\";import{property as e}from\"../core/accessorSupport/decorators/property.js\";import{subclass as t}from\"../core/accessorSupport/decorators/subclass.js\";import\"../core/urlUtils.js\";import\"../core/uuid.js\";import\"../portal/support/resourceExtension.js\";import{substitute as r}from\"../intl/substitute.js\";import{storeNode as o}from\"../widgets/support/widgetUtils.js\";import{messageBundle as i}from\"../widgets/support/decorators/messageBundle.js\";import{j as n}from\"../chunks/index.js\";import u from\"../widgets/Widget.js\";const l={base:\"esri-identity-form\",group:\"esri-identity-form__group\",label:\"esri-identity-form__label\",footer:\"esri-identity-form__footer\",esriInput:\"esri-input\",esriButton:\"esri-button\",esriButtonSecondary:\"esri-button--secondary\"},p=\"ArcGIS Online\";let a=class extends u{constructor(s,e){super(s,e),this._usernameInputNode=null,this._passwordInputNode=null,this.messages=null,this.signingIn=!1,this.server=null,this.resource=null,this.error=null,this.oAuthPrompt=!1}render(){const{error:s,server:e,resource:t,signingIn:i,oAuthPrompt:u,messages:a}=this,d=n(\"div\",{class:l.group},r(u?a.oAuthInfo:a.info,{server:/\\.arcgis\\.com/i.test(e)?p:e,resource:`(${t||a.lblItem})`})),c=u?null:n(\"div\",{class:l.group},n(\"label\",{class:l.label},a.lblUser,n(\"input\",{value:\"\",required:!0,autocomplete:\"off\",spellcheck:!1,type:\"text\",bind:this,afterCreate:o,\"data-node-ref\":\"_usernameInputNode\",class:l.esriInput}))),m=u?null:n(\"div\",{class:l.group},n(\"label\",{class:l.label},a.lblPwd,n(\"input\",{value:\"\",required:!0,type:\"password\",bind:this,afterCreate:o,\"data-node-ref\":\"_passwordInputNode\",class:l.esriInput}))),h=n(\"div\",{class:this.classes(l.group,l.footer)},n(\"input\",{type:\"submit\",disabled:!!i,value:i?a.lblSigning:a.lblOk,class:l.esriButton}),n(\"input\",{type:\"button\",value:a.lblCancel,bind:this,onclick:this._cancel,class:this.classes(l.esriButton,l.esriButtonSecondary)})),b=s?n(\"div\",null,s.details&&s.details.httpStatus?a.invalidUser:a.noAuthService):null;return n(\"form\",{class:l.base,bind:this,onsubmit:this._submit},d,b,c,m,h)}_cancel(){this._set(\"signingIn\",!1),this._usernameInputNode&&(this._usernameInputNode.value=\"\"),this._passwordInputNode&&(this._passwordInputNode.value=\"\"),this.emit(\"cancel\")}_submit(s){s.preventDefault(),this._set(\"signingIn\",!0);const e=this.oAuthPrompt?{}:{username:this._usernameInputNode&&this._usernameInputNode.value,password:this._passwordInputNode&&this._passwordInputNode.value};this.emit(\"submit\",e)}};s([e(),i(\"esri/identity/t9n/identity\")],a.prototype,\"messages\",void 0),s([e()],a.prototype,\"signingIn\",void 0),s([e()],a.prototype,\"server\",void 0),s([e()],a.prototype,\"resource\",void 0),s([e()],a.prototype,\"error\",void 0),s([e()],a.prototype,\"oAuthPrompt\",void 0),a=s([t(\"esri.identity.IdentityForm\")],a);var d=a;export default d;\n","import { tabbable, isFocusable } from 'tabbable';\n\nlet activeFocusDelay;\n\nconst activeFocusTraps = (function () {\n  const trapQueue = [];\n  return {\n    activateTrap(trap) {\n      if (trapQueue.length > 0) {\n        const activeTrap = trapQueue[trapQueue.length - 1];\n        if (activeTrap !== trap) {\n          activeTrap.pause();\n        }\n      }\n\n      const trapIndex = trapQueue.indexOf(trap);\n      if (trapIndex === -1) {\n        trapQueue.push(trap);\n      } else {\n        // move this existing trap to the front of the queue\n        trapQueue.splice(trapIndex, 1);\n        trapQueue.push(trap);\n      }\n    },\n\n    deactivateTrap(trap) {\n      const trapIndex = trapQueue.indexOf(trap);\n      if (trapIndex !== -1) {\n        trapQueue.splice(trapIndex, 1);\n      }\n\n      if (trapQueue.length > 0) {\n        trapQueue[trapQueue.length - 1].unpause();\n      }\n    },\n  };\n})();\n\nconst isSelectableInput = function (node) {\n  return (\n    node.tagName &&\n    node.tagName.toLowerCase() === 'input' &&\n    typeof node.select === 'function'\n  );\n};\n\nconst isEscapeEvent = function (e) {\n  return e.key === 'Escape' || e.key === 'Esc' || e.keyCode === 27;\n};\n\nconst isTabEvent = function (e) {\n  return e.key === 'Tab' || e.keyCode === 9;\n};\n\nconst delay = function (fn) {\n  return setTimeout(fn, 0);\n};\n\n// Array.find/findIndex() are not supported on IE; this replicates enough\n//  of Array.findIndex() for our needs\nconst findIndex = function (arr, fn) {\n  let idx = -1;\n\n  arr.every(function (value, i) {\n    if (fn(value)) {\n      idx = i;\n      return false; // break\n    }\n\n    return true; // next\n  });\n\n  return idx;\n};\n\n/**\n * Get an option's value when it could be a plain value, or a handler that provides\n *  the value.\n * @param {*} value Option's value to check.\n * @param {...*} [params] Any parameters to pass to the handler, if `value` is a function.\n * @returns {*} The `value`, or the handler's returned value.\n */\nconst valueOrHandler = function (value, ...params) {\n  return typeof value === 'function' ? value(...params) : value;\n};\n\nconst createFocusTrap = function (elements, userOptions) {\n  const doc = document;\n\n  const config = {\n    returnFocusOnDeactivate: true,\n    escapeDeactivates: true,\n    delayInitialFocus: true,\n    ...userOptions,\n  };\n\n  const state = {\n    // @type {Array<HTMLElement>}\n    containers: [],\n\n    // list of objects identifying the first and last tabbable nodes in all containers/groups in\n    //  the trap\n    // NOTE: it's possible that a group has no tabbable nodes if nodes get removed while the trap\n    //  is active, but the trap should never get to a state where there isn't at least one group\n    //  with at least one tabbable node in it (that would lead to an error condition that would\n    //  result in an error being thrown)\n    // @type {Array<{ container: HTMLElement, firstTabbableNode: HTMLElement|null, lastTabbableNode: HTMLElement|null }>}\n    tabbableGroups: [],\n\n    nodeFocusedBeforeActivation: null,\n    mostRecentlyFocusedNode: null,\n    active: false,\n    paused: false,\n  };\n\n  let trap; // eslint-disable-line prefer-const -- some private functions reference it, and its methods reference private functions, so we must declare here and define later\n\n  const containersContain = function (element) {\n    return state.containers.some((container) => container.contains(element));\n  };\n\n  const getNodeForOption = function (optionName) {\n    const optionValue = config[optionName];\n    if (!optionValue) {\n      return null;\n    }\n\n    let node = optionValue;\n\n    if (typeof optionValue === 'string') {\n      node = doc.querySelector(optionValue);\n      if (!node) {\n        throw new Error(`\\`${optionName}\\` refers to no known node`);\n      }\n    }\n\n    if (typeof optionValue === 'function') {\n      node = optionValue();\n      if (!node) {\n        throw new Error(`\\`${optionName}\\` did not return a node`);\n      }\n    }\n\n    return node;\n  };\n\n  const getInitialFocusNode = function () {\n    let node;\n\n    if (getNodeForOption('initialFocus') !== null) {\n      node = getNodeForOption('initialFocus');\n    } else if (containersContain(doc.activeElement)) {\n      node = doc.activeElement;\n    } else {\n      const firstTabbableGroup = state.tabbableGroups[0];\n      const firstTabbableNode =\n        firstTabbableGroup && firstTabbableGroup.firstTabbableNode;\n      node = firstTabbableNode || getNodeForOption('fallbackFocus');\n    }\n\n    if (!node) {\n      throw new Error(\n        'Your focus-trap needs to have at least one focusable element'\n      );\n    }\n\n    return node;\n  };\n\n  const updateTabbableNodes = function () {\n    state.tabbableGroups = state.containers\n      .map((container) => {\n        const tabbableNodes = tabbable(container);\n\n        if (tabbableNodes.length > 0) {\n          return {\n            container,\n            firstTabbableNode: tabbableNodes[0],\n            lastTabbableNode: tabbableNodes[tabbableNodes.length - 1],\n          };\n        }\n\n        return undefined;\n      })\n      .filter((group) => !!group); // remove groups with no tabbable nodes\n\n    // throw if no groups have tabbable nodes and we don't have a fallback focus node either\n    if (\n      state.tabbableGroups.length <= 0 &&\n      !getNodeForOption('fallbackFocus')\n    ) {\n      throw new Error(\n        'Your focus-trap must have at least one container with at least one tabbable node in it at all times'\n      );\n    }\n  };\n\n  const tryFocus = function (node) {\n    if (node === doc.activeElement) {\n      return;\n    }\n    if (!node || !node.focus) {\n      tryFocus(getInitialFocusNode());\n      return;\n    }\n\n    node.focus({ preventScroll: !!config.preventScroll });\n    state.mostRecentlyFocusedNode = node;\n\n    if (isSelectableInput(node)) {\n      node.select();\n    }\n  };\n\n  const getReturnFocusNode = function (previousActiveElement) {\n    const node = getNodeForOption('setReturnFocus');\n\n    return node ? node : previousActiveElement;\n  };\n\n  // This needs to be done on mousedown and touchstart instead of click\n  // so that it precedes the focus event.\n  const checkPointerDown = function (e) {\n    if (containersContain(e.target)) {\n      // allow the click since it ocurred inside the trap\n      return;\n    }\n\n    if (valueOrHandler(config.clickOutsideDeactivates, e)) {\n      // immediately deactivate the trap\n      trap.deactivate({\n        // if, on deactivation, we should return focus to the node originally-focused\n        //  when the trap was activated (or the configured `setReturnFocus` node),\n        //  then assume it's also OK to return focus to the outside node that was\n        //  just clicked, causing deactivation, as long as that node is focusable;\n        //  if it isn't focusable, then return focus to the original node focused\n        //  on activation (or the configured `setReturnFocus` node)\n        // NOTE: by setting `returnFocus: false`, deactivate() will do nothing,\n        //  which will result in the outside click setting focus to the node\n        //  that was clicked, whether it's focusable or not; by setting\n        //  `returnFocus: true`, we'll attempt to re-focus the node originally-focused\n        //  on activation (or the configured `setReturnFocus` node)\n        returnFocus: config.returnFocusOnDeactivate && !isFocusable(e.target),\n      });\n      return;\n    }\n\n    // This is needed for mobile devices.\n    // (If we'll only let `click` events through,\n    // then on mobile they will be blocked anyways if `touchstart` is blocked.)\n    if (valueOrHandler(config.allowOutsideClick, e)) {\n      // allow the click outside the trap to take place\n      return;\n    }\n\n    // otherwise, prevent the click\n    e.preventDefault();\n  };\n\n  // In case focus escapes the trap for some strange reason, pull it back in.\n  const checkFocusIn = function (e) {\n    const targetContained = containersContain(e.target);\n    // In Firefox when you Tab out of an iframe the Document is briefly focused.\n    if (targetContained || e.target instanceof Document) {\n      if (targetContained) {\n        state.mostRecentlyFocusedNode = e.target;\n      }\n    } else {\n      // escaped! pull it back in to where it just left\n      e.stopImmediatePropagation();\n      tryFocus(state.mostRecentlyFocusedNode || getInitialFocusNode());\n    }\n  };\n\n  // Hijack Tab events on the first and last focusable nodes of the trap,\n  // in order to prevent focus from escaping. If it escapes for even a\n  // moment it can end up scrolling the page and causing confusion so we\n  // kind of need to capture the action at the keydown phase.\n  const checkTab = function (e) {\n    updateTabbableNodes();\n\n    let destinationNode = null;\n\n    if (state.tabbableGroups.length > 0) {\n      // make sure the target is actually contained in a group\n      const containerIndex = findIndex(state.tabbableGroups, ({ container }) =>\n        container.contains(e.target)\n      );\n\n      if (containerIndex < 0) {\n        // target not found in any group: quite possible focus has escaped the trap,\n        //  so bring it back in to...\n        if (e.shiftKey) {\n          // ...the last node in the last group\n          destinationNode =\n            state.tabbableGroups[state.tabbableGroups.length - 1]\n              .lastTabbableNode;\n        } else {\n          // ...the first node in the first group\n          destinationNode = state.tabbableGroups[0].firstTabbableNode;\n        }\n      } else if (e.shiftKey) {\n        // REVERSE\n        const startOfGroupIndex = findIndex(\n          state.tabbableGroups,\n          ({ firstTabbableNode }) => e.target === firstTabbableNode\n        );\n\n        if (startOfGroupIndex >= 0) {\n          const destinationGroupIndex =\n            startOfGroupIndex === 0\n              ? state.tabbableGroups.length - 1\n              : startOfGroupIndex - 1;\n\n          const destinationGroup = state.tabbableGroups[destinationGroupIndex];\n          destinationNode = destinationGroup.lastTabbableNode;\n        }\n      } else {\n        // FORWARD\n        const lastOfGroupIndex = findIndex(\n          state.tabbableGroups,\n          ({ lastTabbableNode }) => e.target === lastTabbableNode\n        );\n\n        if (lastOfGroupIndex >= 0) {\n          const destinationGroupIndex =\n            lastOfGroupIndex === state.tabbableGroups.length - 1\n              ? 0\n              : lastOfGroupIndex + 1;\n\n          const destinationGroup = state.tabbableGroups[destinationGroupIndex];\n          destinationNode = destinationGroup.firstTabbableNode;\n        }\n      }\n    } else {\n      destinationNode = getNodeForOption('fallbackFocus');\n    }\n\n    if (destinationNode) {\n      e.preventDefault();\n      tryFocus(destinationNode);\n    }\n  };\n\n  const checkKey = function (e) {\n    if (config.escapeDeactivates !== false && isEscapeEvent(e)) {\n      e.preventDefault();\n      trap.deactivate();\n      return;\n    }\n\n    if (isTabEvent(e)) {\n      checkTab(e);\n      return;\n    }\n  };\n\n  const checkClick = function (e) {\n    if (valueOrHandler(config.clickOutsideDeactivates, e)) {\n      return;\n    }\n\n    if (containersContain(e.target)) {\n      return;\n    }\n\n    if (valueOrHandler(config.allowOutsideClick, e)) {\n      return;\n    }\n\n    e.preventDefault();\n    e.stopImmediatePropagation();\n  };\n\n  //\n  // EVENT LISTENERS\n  //\n\n  const addListeners = function () {\n    if (!state.active) {\n      return;\n    }\n\n    // There can be only one listening focus trap at a time\n    activeFocusTraps.activateTrap(trap);\n\n    // Delay ensures that the focused element doesn't capture the event\n    // that caused the focus trap activation.\n    activeFocusDelay = config.delayInitialFocus\n      ? delay(function () {\n          tryFocus(getInitialFocusNode());\n        })\n      : tryFocus(getInitialFocusNode());\n\n    doc.addEventListener('focusin', checkFocusIn, true);\n    doc.addEventListener('mousedown', checkPointerDown, {\n      capture: true,\n      passive: false,\n    });\n    doc.addEventListener('touchstart', checkPointerDown, {\n      capture: true,\n      passive: false,\n    });\n    doc.addEventListener('click', checkClick, {\n      capture: true,\n      passive: false,\n    });\n    doc.addEventListener('keydown', checkKey, {\n      capture: true,\n      passive: false,\n    });\n\n    return trap;\n  };\n\n  const removeListeners = function () {\n    if (!state.active) {\n      return;\n    }\n\n    doc.removeEventListener('focusin', checkFocusIn, true);\n    doc.removeEventListener('mousedown', checkPointerDown, true);\n    doc.removeEventListener('touchstart', checkPointerDown, true);\n    doc.removeEventListener('click', checkClick, true);\n    doc.removeEventListener('keydown', checkKey, true);\n\n    return trap;\n  };\n\n  //\n  // TRAP DEFINITION\n  //\n\n  trap = {\n    activate(activateOptions) {\n      if (state.active) {\n        return this;\n      }\n\n      updateTabbableNodes();\n\n      state.active = true;\n      state.paused = false;\n      state.nodeFocusedBeforeActivation = doc.activeElement;\n\n      const onActivate =\n        activateOptions && activateOptions.onActivate\n          ? activateOptions.onActivate\n          : config.onActivate;\n      if (onActivate) {\n        onActivate();\n      }\n\n      addListeners();\n      return this;\n    },\n\n    deactivate(deactivateOptions) {\n      if (!state.active) {\n        return this;\n      }\n\n      clearTimeout(activeFocusDelay);\n\n      removeListeners();\n      state.active = false;\n      state.paused = false;\n\n      activeFocusTraps.deactivateTrap(trap);\n\n      const onDeactivate =\n        deactivateOptions && deactivateOptions.onDeactivate !== undefined\n          ? deactivateOptions.onDeactivate\n          : config.onDeactivate;\n      if (onDeactivate) {\n        onDeactivate();\n      }\n\n      const returnFocus =\n        deactivateOptions && deactivateOptions.returnFocus !== undefined\n          ? deactivateOptions.returnFocus\n          : config.returnFocusOnDeactivate;\n\n      if (returnFocus) {\n        delay(function () {\n          tryFocus(getReturnFocusNode(state.nodeFocusedBeforeActivation));\n        });\n      }\n\n      return this;\n    },\n\n    pause() {\n      if (state.paused || !state.active) {\n        return this;\n      }\n\n      state.paused = true;\n      removeListeners();\n\n      return this;\n    },\n\n    unpause() {\n      if (!state.paused || !state.active) {\n        return this;\n      }\n\n      state.paused = false;\n      updateTabbableNodes();\n      addListeners();\n\n      return this;\n    },\n\n    updateContainerElements(containerElements) {\n      const elementsAsArray = [].concat(containerElements).filter(Boolean);\n\n      state.containers = elementsAsArray.map((element) =>\n        typeof element === 'string' ? doc.querySelector(element) : element\n      );\n\n      if (state.active) {\n        updateTabbableNodes();\n      }\n\n      return this;\n    },\n  };\n\n  // initialize container elements\n  trap.updateContainerElements(elements);\n\n  return trap;\n};\n\nexport { createFocusTrap };\n","const candidateSelectors = [\n  'input',\n  'select',\n  'textarea',\n  'a[href]',\n  'button',\n  '[tabindex]',\n  'audio[controls]',\n  'video[controls]',\n  '[contenteditable]:not([contenteditable=\"false\"])',\n  'details>summary:first-of-type',\n  'details',\n];\nconst candidateSelector = /* #__PURE__ */ candidateSelectors.join(',');\n\nconst matches =\n  typeof Element === 'undefined'\n    ? function () {}\n    : Element.prototype.matches ||\n      Element.prototype.msMatchesSelector ||\n      Element.prototype.webkitMatchesSelector;\n\nconst getCandidates = function (el, includeContainer, filter) {\n  let candidates = Array.prototype.slice.apply(\n    el.querySelectorAll(candidateSelector)\n  );\n  if (includeContainer && matches.call(el, candidateSelector)) {\n    candidates.unshift(el);\n  }\n  candidates = candidates.filter(filter);\n  return candidates;\n};\n\nconst isContentEditable = function (node) {\n  return node.contentEditable === 'true';\n};\n\nconst getTabindex = function (node) {\n  const tabindexAttr = parseInt(node.getAttribute('tabindex'), 10);\n\n  if (!isNaN(tabindexAttr)) {\n    return tabindexAttr;\n  }\n\n  // Browsers do not return `tabIndex` correctly for contentEditable nodes;\n  // so if they don't have a tabindex attribute specifically set, assume it's 0.\n  if (isContentEditable(node)) {\n    return 0;\n  }\n\n  // in Chrome, <details/>, <audio controls/> and <video controls/> elements get a default\n  //  `tabIndex` of -1 when the 'tabindex' attribute isn't specified in the DOM,\n  //  yet they are still part of the regular tab order; in FF, they get a default\n  //  `tabIndex` of 0; since Chrome still puts those elements in the regular tab\n  //  order, consider their tab index to be 0.\n  if (\n    (node.nodeName === 'AUDIO' ||\n      node.nodeName === 'VIDEO' ||\n      node.nodeName === 'DETAILS') &&\n    node.getAttribute('tabindex') === null\n  ) {\n    return 0;\n  }\n\n  return node.tabIndex;\n};\n\nconst sortOrderedTabbables = function (a, b) {\n  return a.tabIndex === b.tabIndex\n    ? a.documentOrder - b.documentOrder\n    : a.tabIndex - b.tabIndex;\n};\n\nconst isInput = function (node) {\n  return node.tagName === 'INPUT';\n};\n\nconst isHiddenInput = function (node) {\n  return isInput(node) && node.type === 'hidden';\n};\n\nconst isDetailsWithSummary = function (node) {\n  const r =\n    node.tagName === 'DETAILS' &&\n    Array.prototype.slice\n      .apply(node.children)\n      .some((child) => child.tagName === 'SUMMARY');\n  return r;\n};\n\nconst getCheckedRadio = function (nodes, form) {\n  for (let i = 0; i < nodes.length; i++) {\n    if (nodes[i].checked && nodes[i].form === form) {\n      return nodes[i];\n    }\n  }\n};\n\nconst isTabbableRadio = function (node) {\n  if (!node.name) {\n    return true;\n  }\n  const radioScope = node.form || node.ownerDocument;\n\n  const queryRadios = function (name) {\n    return radioScope.querySelectorAll(\n      'input[type=\"radio\"][name=\"' + name + '\"]'\n    );\n  };\n\n  let radioSet;\n  if (\n    typeof window !== 'undefined' &&\n    typeof window.CSS !== 'undefined' &&\n    typeof window.CSS.escape === 'function'\n  ) {\n    radioSet = queryRadios(window.CSS.escape(node.name));\n  } else {\n    try {\n      radioSet = queryRadios(node.name);\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.error(\n        'Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s',\n        err.message\n      );\n      return false;\n    }\n  }\n\n  const checked = getCheckedRadio(radioSet, node.form);\n  return !checked || checked === node;\n};\n\nconst isRadio = function (node) {\n  return isInput(node) && node.type === 'radio';\n};\n\nconst isNonTabbableRadio = function (node) {\n  return isRadio(node) && !isTabbableRadio(node);\n};\n\nconst isHidden = function (node, displayCheck) {\n  if (getComputedStyle(node).visibility === 'hidden') {\n    return true;\n  }\n\n  const isDirectSummary = matches.call(node, 'details>summary:first-of-type');\n  const nodeUnderDetails = isDirectSummary ? node.parentElement : node;\n  if (matches.call(nodeUnderDetails, 'details:not([open]) *')) {\n    return true;\n  }\n  if (!displayCheck || displayCheck === 'full') {\n    while (node) {\n      if (getComputedStyle(node).display === 'none') {\n        return true;\n      }\n      node = node.parentElement;\n    }\n  } else if (displayCheck === 'non-zero-area') {\n    const { width, height } = node.getBoundingClientRect();\n    return width === 0 && height === 0;\n  }\n\n  return false;\n};\n\nconst isNodeMatchingSelectorFocusable = function (options, node) {\n  if (\n    node.disabled ||\n    isHiddenInput(node) ||\n    isHidden(node, options.displayCheck) ||\n    /* For a details element with a summary, the summary element gets the focused  */\n    isDetailsWithSummary(node)\n  ) {\n    return false;\n  }\n  return true;\n};\n\nconst isNodeMatchingSelectorTabbable = function (options, node) {\n  if (\n    !isNodeMatchingSelectorFocusable(options, node) ||\n    isNonTabbableRadio(node) ||\n    getTabindex(node) < 0\n  ) {\n    return false;\n  }\n  return true;\n};\n\nconst tabbable = function (el, options) {\n  options = options || {};\n\n  const regularTabbables = [];\n  const orderedTabbables = [];\n\n  const candidates = getCandidates(\n    el,\n    options.includeContainer,\n    isNodeMatchingSelectorTabbable.bind(null, options)\n  );\n\n  candidates.forEach(function (candidate, i) {\n    const candidateTabindex = getTabindex(candidate);\n    if (candidateTabindex === 0) {\n      regularTabbables.push(candidate);\n    } else {\n      orderedTabbables.push({\n        documentOrder: i,\n        tabIndex: candidateTabindex,\n        node: candidate,\n      });\n    }\n  });\n\n  const tabbableNodes = orderedTabbables\n    .sort(sortOrderedTabbables)\n    .map((a) => a.node)\n    .concat(regularTabbables);\n\n  return tabbableNodes;\n};\n\nconst focusable = function (el, options) {\n  options = options || {};\n\n  const candidates = getCandidates(\n    el,\n    options.includeContainer,\n    isNodeMatchingSelectorFocusable.bind(null, options)\n  );\n\n  return candidates;\n};\n\nconst isTabbable = function (node, options) {\n  options = options || {};\n  if (!node) {\n    throw new Error('No node provided');\n  }\n  if (matches.call(node, candidateSelector) === false) {\n    return false;\n  }\n  return isNodeMatchingSelectorTabbable(options, node);\n};\n\nconst focusableCandidateSelector = /* #__PURE__ */ candidateSelectors\n  .concat('iframe')\n  .join(',');\n\nconst isFocusable = function (node, options) {\n  options = options || {};\n  if (!node) {\n    throw new Error('No node provided');\n  }\n  if (matches.call(node, focusableCandidateSelector) === false) {\n    return false;\n  }\n  return isNodeMatchingSelectorFocusable(options, node);\n};\n\nexport { tabbable, focusable, isTabbable, isFocusable };\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../chunks/tslib.es6.js\";import\"../core/has.js\";import\"../core/Logger.js\";import\"../core/accessorSupport/ensureType.js\";import{makeHandle as e}from\"../core/handleUtils.js\";import{property as o}from\"../core/accessorSupport/decorators/property.js\";import{subclass as s}from\"../core/accessorSupport/decorators/subclass.js\";import\"../core/urlUtils.js\";import\"../core/uuid.js\";import\"../portal/support/resourceExtension.js\";import{messageBundle as i}from\"../widgets/support/decorators/messageBundle.js\";import{j as r}from\"../chunks/index.js\";import{isWidget as n}from\"../widgets/support/widget.js\";import a from\"../widgets/Widget.js\";import{createFocusTrap as c}from\"focus-trap\";const l={base:\"esri-identity-modal\",open:\"esri-identity-modal--open\",closed:\"esri-identity-modal--closed\",title:\"esri-identity-modal__title\",dialog:\"esri-identity-modal__dialog\",content:\"esri-identity-modal__content\",closeButton:\"esri-identity-modal__close-button\",iconClose:\"esri-icon-close\"};let d=class extends a{constructor(t,e){super(t,e),this.container=document.createElement(\"div\"),this.content=null,this.open=!1,this._close=()=>{this.open=!1},document.body.appendChild(this.container),this.own(this.watch(\"open\",(()=>this._toggleFocusTrap())))}destroy(){this._destroyFocusTrap()}render(){const t=this.id,{open:e,content:o,title:s,messages:i}=this,n=e&&!!o,a={[l.open]:n,[l.closed]:!n},c=r(\"button\",{class:l.closeButton,\"aria-label\":i.close,title:i.close,bind:this,onclick:this._close},r(\"span\",{\"aria-hidden\":\"true\",class:l.iconClose})),d=`${t}_title`,p=`${t}_content`,u=s?r(\"h1\",{id:d,class:l.title},s):null,m=n?r(\"div\",{bind:this,class:l.dialog,role:\"dialog\",\"aria-labelledby\":d,\"aria-describedby\":p,afterCreate:this._createFocusTrap},c,u,this._renderContent(p)):null;return r(\"div\",{tabIndex:-1,class:this.classes(l.base,a)},m)}_destroyFocusTrap(){var t;null==(t=this._focusTrap)||t.deactivate({onDeactivate:null}),this._focusTrap=null}_toggleFocusTrap(){const{_focusTrap:t,open:e}=this;t&&(e?t.activate():t.deactivate())}_createFocusTrap(t){this._destroyFocusTrap();const o=requestAnimationFrame((()=>{this._focusTrap=c(t,{initialFocus:\"input\",onDeactivate:this._close}),this._toggleFocusTrap()}));this.own(e((()=>cancelAnimationFrame(o))))}_renderContent(t){const e=this.content;return\"string\"==typeof e?r(\"div\",{class:l.content,id:t,innerHTML:e}):n(e)?r(\"div\",{class:l.content,id:t},e.render()):e instanceof HTMLElement?r(\"div\",{class:l.content,id:t,bind:e,afterCreate:this._attachToNode}):null}_attachToNode(t){const e=this;t.appendChild(e)}};t([o({readOnly:!0})],d.prototype,\"container\",void 0),t([o()],d.prototype,\"content\",void 0),t([o()],d.prototype,\"open\",void 0),t([o(),i(\"esri/t9n/common\")],d.prototype,\"messages\",void 0),t([o({aliasOf:\"messages.auth.signIn\"})],d.prototype,\"title\",void 0),d=t([s(\"esri.identity.IdentityModal\")],d);var p=d;export default p;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nconst t=\"esriJSAPIOAuth\";class s{constructor(t,s){this.oAuthInfo=null,this.storage=null,this.appId=null,this.expires=null,this.ssl=null,this.token=null,this.userId=null,this.oAuthInfo=t,this.storage=s,this._init()}isValid(){let t=!1;if(this.oAuthInfo&&this.token&&this.userId){const s=Date.now();if(this.expires>s){(this.expires-s)/1e3>60*this.oAuthInfo.minTimeUntilExpiration&&(t=!0)}}return t}save(){if(!this.storage)return;const s=this._load(),e=this.oAuthInfo;if(e&&e.authNamespace&&e.portalUrl){let o=s[e.authNamespace];o||(o=s[e.authNamespace]={}),o[e.portalUrl]={appId:this.appId=e.appId,expires:this.expires,ssl:this.ssl,token:this.token,userId:this.userId};try{this.storage.setItem(t,JSON.stringify(s))}catch(i){console.log(i)}}}destroy(){const s=this._load(),e=this.oAuthInfo;if(e&&e.appId&&e.portalUrl&&this.token&&this.expires>Date.now()){const t=e.portalUrl.replace(/^http:/i,\"https:\")+\"/sharing/rest/oauth2/revokeToken\",s=new FormData;if(s.append(\"f\",\"json\"),s.append(\"auth_token\",this.token),s.append(\"client_id\",e.appId),s.append(\"token_type_hint\",\"access_token\"),\"function\"==typeof navigator.sendBeacon)navigator.sendBeacon(t,s);else{const e=new XMLHttpRequest;e.open(\"POST\",t),e.send(s)}}if(e&&e.authNamespace&&e.portalUrl&&this.storage){const o=s[e.authNamespace];if(o){delete o[e.portalUrl];try{this.storage.setItem(t,JSON.stringify(s))}catch(i){console.log(i)}}}e&&(e._oAuthCred=null,this.oAuthInfo=null)}_init(){const t=this._load(),s=this.oAuthInfo;if(s&&s.authNamespace&&s.portalUrl){let e=t[s.authNamespace];e&&(e=e[s.portalUrl],e&&(this.appId=e.appId,this.expires=e.expires,this.ssl=e.ssl,this.token=e.token,this.userId=e.userId))}}_load(){let s={};if(this.storage){const i=this.storage.getItem(t);if(i)try{s=JSON.parse(i)}catch(e){console.log(e)}}return s}}s.prototype.declaredClass=\"esri.identity.OAuthCredential\";export default s;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../chunks/tslib.es6.js\";import\"../core/has.js\";import\"../core/Logger.js\";import\"../core/accessorSupport/ensureType.js\";import{property as r}from\"../core/accessorSupport/decorators/property.js\";import{subclass as t}from\"../core/accessorSupport/decorators/subclass.js\";import\"../core/urlUtils.js\";import\"../core/uuid.js\";import\"../portal/support/resourceExtension.js\";import{JSONSupport as e}from\"../core/JSONSupport.js\";var p;let s=p=class extends e{constructor(o){super(o),this._oAuthCred=null,this.appId=null,this.authNamespace=\"/\",this.expiration=20160,this.forceLogin=!1,this.forceUserId=!1,this.locale=null,this.minTimeUntilExpiration=30,this.popup=!1,this.popupCallbackUrl=\"oauth-callback.html\",this.popupWindowFeatures=\"height=490,width=800,resizable,scrollbars,status\",this.portalUrl=\"https://www.arcgis.com\",this.preserveUrlHash=!1,this.userId=null}clone(){return p.fromJSON(this.toJSON())}};o([r({json:{write:!0}})],s.prototype,\"appId\",void 0),o([r({json:{write:!0}})],s.prototype,\"authNamespace\",void 0),o([r({json:{write:!0}})],s.prototype,\"expiration\",void 0),o([r({json:{write:!0}})],s.prototype,\"forceLogin\",void 0),o([r({json:{write:!0}})],s.prototype,\"forceUserId\",void 0),o([r({json:{write:!0}})],s.prototype,\"locale\",void 0),o([r({json:{write:!0}})],s.prototype,\"minTimeUntilExpiration\",void 0),o([r({json:{write:!0}})],s.prototype,\"popup\",void 0),o([r({json:{write:!0}})],s.prototype,\"popupCallbackUrl\",void 0),o([r({json:{write:!0}})],s.prototype,\"popupWindowFeatures\",void 0),o([r({json:{write:!0}})],s.prototype,\"portalUrl\",void 0),o([r({json:{write:!0}})],s.prototype,\"preserveUrlHash\",void 0),o([r({json:{write:!0}})],s.prototype,\"userId\",void 0),s=p=o([t(\"esri.identity.OAuthInfo\")],s);var i=s;export default i;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../chunks/tslib.es6.js\";import\"../core/has.js\";import\"../core/Logger.js\";import\"../core/accessorSupport/ensureType.js\";import{property as o}from\"../core/accessorSupport/decorators/property.js\";import{subclass as e}from\"../core/accessorSupport/decorators/subclass.js\";import\"../core/urlUtils.js\";import\"../core/uuid.js\";import\"../portal/support/resourceExtension.js\";import{JSONSupport as t}from\"../core/JSONSupport.js\";let s=class extends t{constructor(r){super(r),this.adminTokenServiceUrl=null,this.currentVersion=null,this.hasPortal=null,this.hasServer=null,this.owningSystemUrl=null,this.owningTenant=null,this.server=null,this.shortLivedTokenValidity=null,this.tokenServiceUrl=null,this.webTierAuth=null}};r([o({json:{write:!0}})],s.prototype,\"adminTokenServiceUrl\",void 0),r([o({json:{write:!0}})],s.prototype,\"currentVersion\",void 0),r([o({json:{write:!0}})],s.prototype,\"hasPortal\",void 0),r([o({json:{write:!0}})],s.prototype,\"hasServer\",void 0),r([o({json:{write:!0}})],s.prototype,\"owningSystemUrl\",void 0),r([o({json:{write:!0}})],s.prototype,\"owningTenant\",void 0),r([o({json:{write:!0}})],s.prototype,\"server\",void 0),r([o({json:{write:!0}})],s.prototype,\"shortLivedTokenValidity\",void 0),r([o({json:{write:!0}})],s.prototype,\"tokenServiceUrl\",void 0),r([o({json:{write:!0}})],s.prototype,\"webTierAuth\",void 0),s=r([e(\"esri.identity.ServerInfo\")],s);var i=s;export default i;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import t from\"../core/global.js\";import\"../core/has.js\";import{fixJson as s}from\"../core/lang.js\";import{getDeepValue as r}from\"../core/object.js\";import i from\"../config.js\";import\"../core/Logger.js\";import\"../core/accessorSupport/ensureType.js\";import{property as o}from\"../core/accessorSupport/decorators/property.js\";import{subclass as n}from\"../core/accessorSupport/decorators/subclass.js\";import a from\"../core/Error.js\";import{urlToObject as h,hasSameOrigin as l,Url as c,queryToObject as d,normalize as u,getProxyRule as p,makeAbsolute as _,objectToQuery as f}from\"../core/urlUtils.js\";import\"../core/uuid.js\";import\"../portal/support/resourceExtension.js\";import{on as g}from\"../core/events.js\";import{createAbortController as m,createResolver as v,onAbort as S,isAborted as w}from\"../core/promiseUtils.js\";import I from\"../core/Evented.js\";import{id as k}from\"../kernel.js\";import A from\"../request.js\";import y from\"./IdentityForm.js\";import U from\"./IdentityModal.js\";import x from\"./OAuthCredential.js\";import T from\"./OAuthInfo.js\";import O from\"./ServerInfo.js\";const R={},b=e=>{const t=new c(e.owningSystemUrl).host,s=new c(e.server).host,r=/.+\\.arcgis\\.com$/i;return r.test(t)&&r.test(s)},P=(e,t)=>!!(b(e)&&t&&t.some((t=>t.test(e.server))));let C=null,D=null;try{C=window.localStorage,D=window.sessionStorage}catch{}let j=class extends I{constructor(){super(),this._portalConfig=t.esriGeowConfig,this.serverInfos=[],this.oAuthInfos=[],this.credentials=[],this._soReqs=[],this._xoReqs=[],this._portals=[],this.defaultOAuthInfo=null,this.defaultTokenValidity=60,this.dialog=null,this.formConstructor=y,this.tokenValidity=null,this.normalizeWebTierAuth=!1,this._appUrlObj=h(window.location.href),this._busy=null,this._rejectOnPersistedPageShow=!1,this._oAuthHash=null,this._gwTokenUrl=\"/sharing/rest/generateToken\",this._agsRest=\"/rest/services\",this._agsPortal=/\\/sharing(\\/|$)/i,this._agsAdmin=/(https?:\\/\\/[^\\/]+\\/[^\\/]+)\\/admin\\/?(\\/.*)?$/i,this._adminSvcs=/\\/rest\\/admin\\/services(\\/|$)/i,this._gwDomains=[{regex:/^https?:\\/\\/www\\.arcgis\\.com/i,customBaseUrl:\"maps.arcgis.com\",tokenServiceUrl:\"https://www.arcgis.com/sharing/rest/generateToken\"},{regex:/^https?:\\/\\/(?:dev|[a-z\\d-]+\\.mapsdev)\\.arcgis\\.com/i,customBaseUrl:\"mapsdev.arcgis.com\",tokenServiceUrl:\"https://dev.arcgis.com/sharing/rest/generateToken\"},{regex:/^https?:\\/\\/(?:devext|[a-z\\d-]+\\.mapsdevext)\\.arcgis\\.com/i,customBaseUrl:\"mapsdevext.arcgis.com\",tokenServiceUrl:\"https://devext.arcgis.com/sharing/rest/generateToken\"},{regex:/^https?:\\/\\/(?:qaext|[a-z\\d-]+\\.mapsqa)\\.arcgis\\.com/i,customBaseUrl:\"mapsqa.arcgis.com\",tokenServiceUrl:\"https://qaext.arcgis.com/sharing/rest/generateToken\"},{regex:/^https?:\\/\\/[a-z\\d-]+\\.maps\\.arcgis\\.com/i,customBaseUrl:\"maps.arcgis.com\",tokenServiceUrl:\"https://www.arcgis.com/sharing/rest/generateToken\"}],this._legacyFed=[],this._regexSDirUrl=/http.+\\/rest\\/services\\/?/gi,this._regexServerType=/(\\/(FeatureServer|GPServer|GeoDataServer|GeocodeServer|GeoenrichmentServer|GeometryServer|GlobeServer|ImageServer|MapServer|MobileServer|NAServer|NetworkDiagramServer|ParcelFabricServer|RelationalCatalogServer|SceneServer|StreamServer|UtilityNetworkServer|ValidationServer|VectorTileServer|VersionManagementServer)).*/gi,this._gwUser=/http.+\\/users\\/([^\\/]+)\\/?.*/i,this._gwItem=/http.+\\/items\\/([^\\/]+)\\/?.*/i,this._gwGroup=/http.+\\/groups\\/([^\\/]+)\\/?.*/i,this._rePortalTokenSvc=/\\/sharing(\\/rest)?\\/generatetoken/i,this._createDefaultOAuthInfo=!0,this._hasTestedIfAppIsOnPortal=!1,this._getOAuthHash(),window.addEventListener(\"pageshow\",(e=>{this._pageShowHandler(e)}))}registerServers(e){const t=this.serverInfos;t?(e=e.filter((e=>!this.findServerInfo(e.server))),this.serverInfos=t.concat(e)):this.serverInfos=e,e.forEach((e=>{e.owningSystemUrl&&this._portals.push(e.owningSystemUrl),e.hasPortal&&this._portals.push(e.server)}))}registerOAuthInfos(e){const t=this.oAuthInfos;if(t){for(const s of e){const e=this.findOAuthInfo(s.portalUrl);e&&t.splice(t.indexOf(e),1)}this.oAuthInfos=t.concat(e)}else this.oAuthInfos=e}registerToken(e){e={...e};const t=this._sanitizeUrl(e.server),s=this._isServerRsrc(t);let r,i=this.findServerInfo(t),o=!0;i||(i=new O,i.server=this._getServerInstanceRoot(t),s?i.hasServer=!0:(i.tokenServiceUrl=this._getTokenSvcUrl(t),i.hasPortal=!0),this.registerServers([i])),r=this._findCredential(t),r?(delete e.server,Object.assign(r,e),o=!1):(r=new q({userId:e.userId,server:i.server,token:e.token,expires:e.expires,ssl:e.ssl,scope:s?\"server\":\"portal\"}),r.resources=[t],this.credentials.push(r)),r.emitTokenChange(!1),o||r.refreshServerTokens()}toJSON(){return s({serverInfos:this.serverInfos.map((e=>e.toJSON())),oAuthInfos:this.oAuthInfos.map((e=>e.toJSON())),credentials:this.credentials.map((e=>e.toJSON()))})}initialize(e){if(!e)return;\"string\"==typeof e&&(e=JSON.parse(e));const t=e.serverInfos,s=e.oAuthInfos,r=e.credentials;if(t){const e=[];t.forEach((t=>{t.server&&t.tokenServiceUrl&&e.push(t.declaredClass?t:new O(t))})),e.length&&this.registerServers(e)}if(s){const e=[];s.forEach((t=>{t.appId&&e.push(t.declaredClass?t:new T(t))})),e.length&&this.registerOAuthInfos(e)}r&&r.forEach((e=>{e.server&&e.token&&e.expires&&e.expires>Date.now()&&((e=e.declaredClass?e:new q(e)).emitTokenChange(),this.credentials.push(e))}))}findServerInfo(e){let t;e=this._sanitizeUrl(e);for(const s of this.serverInfos)if(this._hasSameServerInstance(s.server,e)){t=s;break}return t}findOAuthInfo(e){let t;e=this._sanitizeUrl(e);for(const s of this.oAuthInfos)if(this._hasSameServerInstance(s.portalUrl,e)){t=s;break}return t}findCredential(e,t){let s;e=this._sanitizeUrl(e);const r=this._isServerRsrc(e)?\"server\":\"portal\";if(t){for(const i of this.credentials)if(this._hasSameServerInstance(i.server,e)&&t===i.userId&&i.scope===r){s=i;break}}else for(const i of this.credentials)if(this._hasSameServerInstance(i.server,e)&&-1!==this._getIdenticalSvcIdx(e,i)&&i.scope===r){s=i;break}return s}getCredential(e,t){let s,r,i=!0;t&&(s=!!t.token,r=t.error,i=!1!==t.prompt),t={...t},e=this._sanitizeUrl(e);const o=m(),n=v();if(t.signal&&S(t.signal,(()=>{o.abort()})),S(o,(()=>{n.reject(new a(\"identity-manager:user-aborted\",\"ABORTED\"))})),w(o))return n.promise;t.signal=o.signal;const h=this._isAdminResource(e),c=s?this.findCredential(e):null;let d;if(c&&r&&r.details&&498===r.details.httpStatus)c.destroy();else if(c)return d=new a(\"identity-manager:not-authorized\",\"You are currently signed in as: '\"+c.userId+\"'. You do not have access to this resource: \"+e,{error:r}),n.reject(d),n.promise;const u=this._findCredential(e,t);if(u)return n.resolve(u),n.promise;let p=this.findServerInfo(e);if(p)!p.hasServer&&this._isServerRsrc(e)&&(p._restInfoPms=this._getTokenSvcUrl(e),p.hasServer=!0);else{const t=this._getTokenSvcUrl(e);if(!t)return d=new a(\"identity-manager:unknown-resource\",\"Unknown resource - could not find token service endpoint.\"),n.reject(d),n.promise;p=new O,p.server=this._getServerInstanceRoot(e),\"string\"==typeof t?(p.tokenServiceUrl=t,p.hasPortal=!0):(p._restInfoPms=t,p.hasServer=!0),this.registerServers([p])}return p.hasPortal&&void 0===p._selfReq&&(i||l(p.tokenServiceUrl,window.location.origin)||this._gwDomains.some((e=>e.tokenServiceUrl===p.tokenServiceUrl)))&&(p._selfReq={owningTenant:t&&t.owningTenant,selfDfd:this._getPortalSelf(p.tokenServiceUrl.replace(this._rePortalTokenSvc,\"/sharing/rest/portals/self\"),e)}),this._enqueue(e,p,t,n,h)}getResourceName(e){return this._isRESTService(e)?e.replace(this._regexSDirUrl,\"\").replace(this._regexServerType,\"\")||\"\":this._gwUser.test(e)&&e.replace(this._gwUser,\"$1\")||this._gwItem.test(e)&&e.replace(this._gwItem,\"$1\")||this._gwGroup.test(e)&&e.replace(this._gwGroup,\"$1\")||\"\"}generateToken(e,t,s){const r=this._rePortalTokenSvc.test(e.tokenServiceUrl),i=new c(window.location.href.toLowerCase()),o=e.shortLivedTokenValidity;let n,h,d,u,p,_,f,g;t&&(g=this.tokenValidity||o||this.defaultTokenValidity,g>o&&o>0&&(g=o)),s&&(n=s.isAdmin,h=s.serverUrl,d=s.token,_=s.signal,f=s.ssl,e.customParameters=s.customParameters),n?u=e.adminTokenServiceUrl:(u=e.tokenServiceUrl,p=new c(u.toLowerCase()),e.webTierAuth&&s&&s.serverUrl&&!f&&\"http\"===i.scheme&&(l(i.uri,u,!0)||\"https\"===p.scheme&&i.host===p.host&&\"7080\"===i.port&&\"7443\"===p.port)&&(u=u.replace(/^https:/i,\"http:\").replace(/:7443/i,\":7080\")));const m={query:{request:\"getToken\",username:null==t?void 0:t.username,password:null==t?void 0:t.password,serverUrl:h,token:d,expiration:g,referer:n||r?window.location.host:null,client:n?\"referer\":null,f:\"json\",...e.customParameters},method:\"post\",authMode:\"anonymous\",useProxy:this._useProxy(e,s),signal:_,...null==s?void 0:s.ioArgs};r||(m.withCredentials=!1);return A(u,m).then((s=>{const r=s.data;if(!r||!r.token)return new a(\"identity-manager:authentication-failed\",\"Unable to generate token\");const i=e.server;return R[i]||(R[i]={}),t&&(R[i][t.username]=t.password),r.validity=g,r}))}isBusy(){return!!this._busy}checkSignInStatus(e){return this.checkAppAccess(e,\"\").then((e=>e.credential))}checkAppAccess(e,t,s){let r=!1;return this.getCredential(e,{prompt:!1}).then((i=>{let o;const n={f:\"json\"};if(\"portal\"===i.scope)if(t&&(this._doPortalSignIn(e)||s&&s.force))o=i.server+\"/sharing/rest/oauth2/validateAppAccess\",n.client_id=t;else{if(!i.token)return{credential:i};o=i.server+\"/sharing/rest\"}else{if(!i.token)return{credential:i};o=i.server+\"/rest/services\"}return i.token&&(n.token=i.token),A(o,{query:n,authMode:\"anonymous\"}).then((e=>{if(!1===e.data.valid)throw new a(\"identity-manager:not-authorized\",`You are currently signed in as: '${i.userId}'.`,e.data);return r=!!e.data.viewOnlyUserTypeApp,{credential:i}})).catch((e=>{if(\"identity-manager:not-authorized\"===e.name)throw e;const t=e.details&&e.details.httpStatus;if(498===t)throw i.destroy(),new a(\"identity-manager:not-authenticated\",\"User is not signed in.\");if(400===t)throw new a(\"identity-manager:invalid-request\");return{credential:i}}))})).then((e=>({credential:e.credential,viewOnly:r})))}setOAuthResponseHash(e){var t;const s=this._oAuthDfd;if(this._oAuthDfd=null,!s||!e)return;clearInterval(this._oAuthIntervalId),null==(t=this._oAuthOnHashHandle)||t.remove(),\"#\"===e.charAt(0)&&(e=e.substring(1));const r=d(e);if(r.error){const e=\"access_denied\"===r.error,t=new a(e?\"identity-manager:user-aborted\":\"identity-manager:authentication-failed\",e?\"ABORTED\":\"OAuth: \"+r.error+\" - \"+r.error_description);s.reject(t)}else{const e=s.sinfo_,t=s.oinfo_,i=t._oAuthCred,o=new q({userId:r.username,server:e.server,token:r.access_token,expires:Date.now()+1e3*Number(r.expires_in),ssl:\"true\"===r.ssl,_oAuthCred:i});t.userId=o.userId,i.storage=r.persist?C:D,i.token=o.token,i.expires=o.expires,i.userId=o.userId,i.ssl=o.ssl,i.save(),s.resolve(o)}}setOAuthRedirectionHandler(e){this._oAuthRedirectFunc=e}setProtocolErrorHandler(e){this._protocolFunc=e}signIn(e,t,s={}){const r=v(),i=()=>{var e,t,s,r,i;null==(e=h)||e.remove(),null==(t=l)||t.remove(),null==(s=c)||s.remove(),null==(r=n)||r.destroy(),null==(i=this.dialog)||i.destroy(),this.dialog=n=h=l=c=null},o=()=>{i(),this._oAuthDfd=null,r.reject(new a(\"identity-manager:user-aborted\",\"ABORTED\"))};s.signal&&S(s.signal,(()=>{o()}));let n=new this.formConstructor;n.resource=this.getResourceName(e),n.server=t.server,this.dialog=new U,this.dialog.content=n,this.dialog.open=!0,this.emit(\"dialog-create\");let h=n.on(\"cancel\",o),l=this.dialog.watch(\"open\",o),c=n.on(\"submit\",(e=>{this.generateToken(t,e,{isAdmin:s.isAdmin,signal:s.signal}).then((o=>{i();const n=new q({userId:e.username,server:t.server,token:o.token,expires:null!=o.expires?Number(o.expires):null,ssl:!!o.ssl,isAdmin:s.isAdmin,validity:o.validity});r.resolve(n)})).catch((e=>{n.error=e,n.signingIn=!1}))}));return r.promise}oAuthSignIn(e,t,s,r){this._oAuthDfd=v();const i=this._oAuthDfd;null!=r&&r.signal&&S(r.signal,(()=>{const e=this._oAuthDfd&&this._oAuthDfd.oAuthWin_;e&&!e.closed?e.close():this.dialog&&h()})),i.resUrl_=e,i.sinfo_=t,i.oinfo_=s;const o=!r||!1!==r.oAuthPopupConfirmation;if(!s.popup||!o)return this._doOAuthSignIn(e,t,s),i.promise;const n=new this.formConstructor;n.oAuthPrompt=!0,n.server=t.server,this.dialog=new U,this.dialog.content=n,this.dialog.open=!0,this.emit(\"dialog-create\");const h=()=>{u(),this._oAuthDfd=null,i.reject(new a(\"identity-manager:user-aborted\",\"ABORTED\"))},l=n.on(\"cancel\",h),c=this.dialog.watch(\"open\",h),d=n.on(\"submit\",(()=>{u(),this._doOAuthSignIn(e,t,s)})),u=()=>{l.remove(),c.remove(),d.remove(),n.destroy(),this.dialog.destroy(),this.dialog=null};return i.promise}destroyCredentials(){if(this.credentials){this.credentials.slice().forEach((e=>{e.destroy()}))}this.emit(\"credentials-destroy\")}enablePostMessageAuth(e=\"https://www.arcgis.com/sharing/rest\"){this._postMessageAuthHandle&&this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=g(window,\"message\",(t=>{var s;if((t.origin===window.location.origin||t.origin.endsWith(\".arcgis.com\"))&&\"arcgis:auth:requestCredential\"===(null==(s=t.data)?void 0:s.type)){const s=t.source;this.getCredential(e).then((e=>{s.postMessage({type:\"arcgis:auth:credential\",credential:{expires:e.expires,server:e.server,ssl:e.ssl,token:e.token,userId:e.userId}},t.origin)})).catch((e=>{s.postMessage({type:\"arcgis:auth:error\",error:{name:e.name,message:e.message}},t.origin)}))}}))}disablePostMessageAuth(){this._postMessageAuthHandle&&(this._postMessageAuthHandle.remove(),this._postMessageAuthHandle=null)}_getOAuthHash(){let e=window.location.hash;if(e){\"#\"===e.charAt(0)&&(e=e.substring(1));const t=d(e);let s=!1;if(t.access_token&&t.expires_in&&t.state&&t.hasOwnProperty(\"username\"))try{t.state=JSON.parse(t.state),\"object\"==typeof t.state&&t.state.portalUrl&&(this._oAuthHash=t,s=!0)}catch{}else t.error&&t.error_description&&(console.log(\"IdentityManager OAuth Error: \",t.error,\" - \",t.error_description),\"access_denied\"===t.error&&(s=!0));s&&(window.location.hash=\"object\"==typeof t.state&&t.state.hash||\"\")}}_pageShowHandler(e){if(e.persisted&&this.isBusy()&&this._rejectOnPersistedPageShow){const e=new a(\"identity-manager:user-aborted\",\"ABORTED\");this._errbackFunc(e)}}_findCredential(e,t){let s,r,i,o,n=-1;const a=t&&t.token,h=t&&t.resource,l=this._isServerRsrc(e)?\"server\":\"portal\",c=this.credentials.filter((t=>this._hasSameServerInstance(t.server,e)&&t.scope===l));if(e=h||e,c.length)if(1===c.length){if(s=c[0],o=this.findServerInfo(s.server),r=o&&o.owningSystemUrl,i=r&&this.findCredential(r,s.userId),n=this._getIdenticalSvcIdx(e,s),!a)return-1===n&&s.resources.push(e),this._addResource(e,i),s;-1!==n&&(s.resources.splice(n,1),this._removeResource(e,i))}else{let t,s;if(c.some((a=>(s=this._getIdenticalSvcIdx(e,a),-1!==s&&(t=a,o=this.findServerInfo(t.server),r=o&&o.owningSystemUrl,i=r&&this.findCredential(r,t.userId),n=s,!0)))),a)t&&(t.resources.splice(n,1),this._removeResource(e,i));else if(t)return this._addResource(e,i),t}}_findOAuthInfo(e){let t=this.findOAuthInfo(e);if(!t)for(const s of this.oAuthInfos)if(this._isIdProvider(s.portalUrl,e)){t=s;break}return t}_addResource(e,t){t&&-1===this._getIdenticalSvcIdx(e,t)&&t.resources.push(e)}_removeResource(e,t){let s=-1;t&&(s=this._getIdenticalSvcIdx(e,t),s>-1&&t.resources.splice(s,1))}_useProxy(e,t){return t&&t.isAdmin&&!l(e.adminTokenServiceUrl,window.location.href)||!this._isPortalDomain(e.tokenServiceUrl)&&\"10.1\"===String(e.currentVersion)&&!l(e.tokenServiceUrl,window.location.href)}_getOrigin(e){const t=new c(e);return t.scheme+\"://\"+t.host+(null!=t.port?\":\"+t.port:\"\")}_getServerInstanceRoot(e){const t=e.toLowerCase();let s=t.indexOf(this._agsRest);return-1===s&&this._isAdminResource(e)&&(s=this._agsAdmin.test(e)?e.replace(this._agsAdmin,\"$1\").length:e.search(this._adminSvcs)),-1===s&&(s=t.indexOf(\"/sharing\")),-1===s&&\"/\"===t.substr(-1)&&(s=t.length-1),s>-1?e.substring(0,s):e}_hasSameServerInstance(e,t){return\"/\"===e.substr(-1)&&(e=e.slice(0,-1)),e=e.toLowerCase(),t=this._getServerInstanceRoot(t).toLowerCase(),e=this._normalizeAGOLorgDomain(e),t=this._normalizeAGOLorgDomain(t),(e=e.substr(e.indexOf(\":\")))===(t=t.substr(t.indexOf(\":\")))}_normalizeAGOLorgDomain(e){const t=/^https?:\\/\\/(?:cdn|[a-z\\d-]+\\.maps)\\.arcgis\\.com/i,s=/^https?:\\/\\/(?:cdndev|[a-z\\d-]+\\.mapsdevext)\\.arcgis\\.com/i,r=/^https?:\\/\\/(?:cdnqa|[a-z\\d-]+\\.mapsqa)\\.arcgis\\.com/i;return t.test(e)?e=e.replace(t,\"https://www.arcgis.com\"):s.test(e)?e=e.replace(s,\"https://devext.arcgis.com\"):r.test(e)&&(e=e.replace(r,\"https://qaext.arcgis.com\")),e}_sanitizeUrl(e){const t=(i.request.proxyUrl||\"\").toLowerCase(),s=t?e.toLowerCase().indexOf(t+\"?\"):-1;return-1!==s&&(e=e.substring(s+t.length+1)),e=u(e),h(e).path}_isRESTService(e){return e.indexOf(this._agsRest)>-1}_isAdminResource(e){return this._agsAdmin.test(e)||this._adminSvcs.test(e)}_isServerRsrc(e){return this._isRESTService(e)||this._isAdminResource(e)}_isIdenticalService(e,t){let s;if(this._isRESTService(e)&&this._isRESTService(t)){const r=this._getSuffix(e).toLowerCase(),i=this._getSuffix(t).toLowerCase();if(s=r===i,!s){const e=/(.*)\\/(MapServer|FeatureServer).*/gi;s=r.replace(e,\"$1\")===i.replace(e,\"$1\")}}else this._isAdminResource(e)&&this._isAdminResource(t)?s=!0:this._isServerRsrc(e)||this._isServerRsrc(t)||!this._isPortalDomain(e)||(s=!0);return s}_isPortalDomain(e){const t=new c(e.toLowerCase()),s=this._portalConfig;let r=this._gwDomains.some((e=>e.regex.test(t.uri)));return!r&&s&&(r=this._hasSameServerInstance(this._getServerInstanceRoot(s.restBaseUrl),t.uri)),r||i.portalUrl&&(r=l(t,i.portalUrl,!0)),r||(r=this._portals.some((e=>this._hasSameServerInstance(e,t.uri)))),r=r||this._agsPortal.test(t.path),r}_isIdProvider(e,t){let s=-1,r=-1;this._gwDomains.forEach(((i,o)=>{-1===s&&i.regex.test(e)&&(s=o),-1===r&&i.regex.test(t)&&(r=o)}));let i=!1;if(s>-1&&r>-1&&(0===s||4===s?0!==r&&4!==r||(i=!0):1===s?1!==r&&2!==r||(i=!0):2===s?2===r&&(i=!0):3===s&&3===r&&(i=!0)),!i){const s=this.findServerInfo(t),r=s&&s.owningSystemUrl;r&&b(s)&&this._isPortalDomain(r)&&this._isIdProvider(e,r)&&(i=!0)}return i}_getIdenticalSvcIdx(e,t){let s=-1;for(let r=0;r<t.resources.length;r++){const i=t.resources[r];if(this._isIdenticalService(e,i)){s=r;break}}return s}_getSuffix(e){return e.replace(this._regexSDirUrl,\"\").replace(this._regexServerType,\"$1\")}_getTokenSvcUrl(e){let t,s,r;if(this._isRESTService(e)||this._isAdminResource(e)){const r=this._getServerInstanceRoot(e);return t=r+\"/admin/generateToken\",s=A(e=r+\"/rest/info\",{query:{f:\"json\"}}).then((e=>e.data)),{adminUrl:t,promise:s}}if(this._isPortalDomain(e)){let t=\"\";if(this._gwDomains.some((s=>(s.regex.test(e)&&(t=s.tokenServiceUrl),!!t))),t||this._portals.some((s=>(this._hasSameServerInstance(s,e)&&(t=s+this._gwTokenUrl),!!t))),t||(r=e.toLowerCase().indexOf(\"/sharing\"),-1!==r&&(t=e.substring(0,r)+this._gwTokenUrl)),t||(t=this._getOrigin(e)+this._gwTokenUrl),t){const s=new c(e).port;/^http:\\/\\//i.test(e)&&\"7080\"===s&&(t=t.replace(/:7080/i,\":7443\")),t=t.replace(/http:/i,\"https:\")}return t}if(-1!==e.toLowerCase().indexOf(\"premium.arcgisonline.com\"))return\"https://premium.arcgisonline.com/server/tokens\"}_exchangeToken(e,t,s){return A(`${e}/sharing/rest/oauth2/exchangeToken`,{authMode:\"anonymous\",method:\"post\",query:{f:\"json\",client_id:t,token:s}}).then((e=>e.data.token))}_getPlatformSelf(e,t){return A(`${e}/sharing/rest/oauth2/platformSelf`,{authMode:\"anonymous\",headers:{\"X-Esri-Auth-Client-Id\":t,\"X-Esri-Auth-Redirect-Uri\":window.location.href.replace(/#.*$/,\"\")},method:\"post\",query:{f:\"json\"},withCredentials:!0}).then((e=>e.data))}_getPortalSelf(e,t){let s;if(this._gwDomains.some((t=>(t.regex.test(e)&&(s=t.customBaseUrl),!!s))),s)return Promise.resolve({allSSL:!0,currentVersion:\"4.4\",customBaseUrl:s,portalMode:\"multitenant\",supportsOAuth:!0});\"https:\"===window.location.protocol?e=e.replace(/^http:/i,\"https:\").replace(/:7080/i,\":7443\"):/^http:/i.test(t)&&(e=e.replace(/^https:/i,\"http:\").replace(/:7443/i,\":7080\"));return A(e,{query:{f:\"json\"},authMode:\"anonymous\",withCredentials:!0}).then((e=>e.data))}_doPortalSignIn(e){const t=this._portalConfig,s=window.location.href,r=this.findServerInfo(e);return!(!t&&!this._isPortalDomain(s)||!(r?r.hasPortal||r.owningSystemUrl&&this._isPortalDomain(r.owningSystemUrl):this._isPortalDomain(e))||!(this._isIdProvider(s,e)||t&&(this._hasSameServerInstance(this._getServerInstanceRoot(t.restBaseUrl),e)||this._isIdProvider(t.restBaseUrl,e))||l(s,e,!0)))}_checkProtocol(e,t,s,r){let i=!0;const o=r?t.adminTokenServiceUrl:t.tokenServiceUrl;if(0===o.trim().toLowerCase().indexOf(\"https:\")&&0!==window.location.href.toLowerCase().indexOf(\"https:\")&&p(o)&&(i=!!this._protocolFunc&&!!this._protocolFunc({resourceUrl:e,serverInfo:t}),!i)){s(new a(\"identity-manager:aborted\",\"Aborted the Sign-In process to avoid sending password over insecure connection.\"))}return i}_enqueue(e,t,s,r,i,o){return r||(r=v()),r.resUrl_=e,r.sinfo_=t,r.options_=s,r.admin_=i,r.refresh_=o,this._busy?this._hasSameServerInstance(this._getServerInstanceRoot(e),this._busy.resUrl_)?(this._oAuthDfd&&this._oAuthDfd.oAuthWin_&&this._oAuthDfd.oAuthWin_.focus(),this._soReqs.push(r)):this._xoReqs.push(r):this._doSignIn(r),r.promise}_doSignIn(e){this._busy=e,this._rejectOnPersistedPageShow=!1;const t=t=>{const s=e.options_&&e.options_.resource,r=e.resUrl_,i=e.refresh_;let o=!1;-1===this.credentials.indexOf(t)&&(i&&-1!==this.credentials.indexOf(i)?(i.userId=t.userId,i.token=t.token,i.expires=t.expires,i.validity=t.validity,i.ssl=t.ssl,i.creationTime=t.creationTime,o=!0,t=i):this.credentials.push(t)),t.resources||(t.resources=[]),t.resources.push(s||r),t.scope=this._isServerRsrc(r)?\"server\":\"portal\",t.emitTokenChange();const n=this._soReqs,a={};this._soReqs=[],n.forEach((e=>{if(!this._isIdenticalService(r,e.resUrl_)){const s=this._getSuffix(e.resUrl_);a[s]||(a[s]=!0,t.resources.push(e.resUrl_))}})),e.resolve(t),n.forEach((e=>{this._hasSameServerInstance(this._getServerInstanceRoot(r),e.resUrl_)?e.resolve(t):this._soReqs.push(e)})),this._busy=e.resUrl_=e.sinfo_=e.refresh_=null,o||this.emit(\"credential-create\",{credential:t}),this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},s=t=>{e.reject(t),this._busy=e.resUrl_=e.sinfo_=e.refresh_=null,this._soReqs.length?this._doSignIn(this._soReqs.shift()):this._xoReqs.length&&this._doSignIn(this._xoReqs.shift())},i=(r,i,o,n)=>{var h,c;const d=e.sinfo_,u=!e.options_||!1!==e.options_.prompt,p=d.hasPortal&&this._findOAuthInfo(e.resUrl_);let _,f;if(r)t(new q({userId:r,server:d.server,token:o||null,expires:null!=n?Number(n):null,ssl:!!i}));else if(window!==window.parent&&null!=(h=this._appUrlObj.query)&&h[\"arcgis-auth-origin\"]&&null!=(c=this._appUrlObj.query)&&c[\"arcgis-auth-portal\"]&&this._hasSameServerInstance(this._getServerInstanceRoot(this._appUrlObj.query[\"arcgis-auth-portal\"]),e.resUrl_)){var m;window.parent.postMessage({type:\"arcgis:auth:requestCredential\"},this._appUrlObj.query[\"arcgis-auth-origin\"]);const r=g(window,\"message\",(e=>{e.source===window.parent&&e.data&&(\"arcgis:auth:credential\"===e.data.type?(r.remove(),t(new q(e.data.credential))):\"arcgis:auth:error\"===e.data.type&&(r.remove(),s(a.fromJSON(e.data.error))))}));S(null==(m=e.options_)?void 0:m.signal,(()=>{r.remove()}))}else if(p){let r=p._oAuthCred;if(!r){const e=new x(p,C),t=new x(p,D);e.isValid()&&t.isValid()?e.expires>t.expires?(r=e,t.destroy()):(r=t,e.destroy()):r=e.isValid()?e:t,p._oAuthCred=r}if(r.isValid())_=new q({userId:r.userId,server:d.server,token:r.token,expires:r.expires,ssl:r.ssl,_oAuthCred:r}),p.appId!==r.appId&&this._doPortalSignIn(e.resUrl_)?e._pendingDfd=this._exchangeToken(_.server,p.appId,_.token).then((e=>{_.token=e,r.token=e,r.save(),t(_)})).catch((()=>{t(_)})):t(_);else if(this._oAuthHash&&this._hasSameServerInstance(p.portalUrl,this._oAuthHash.state.portalUrl)){const e=this._oAuthHash;_=new q({userId:e.username,server:d.server,token:e.access_token,expires:Date.now()+1e3*Number(e.expires_in),ssl:\"true\"===e.ssl,oAuthState:e.state,_oAuthCred:r}),p.userId=_.userId,r.storage=e.persist?C:D,r.token=_.token,r.expires=_.expires,r.userId=_.userId,r.ssl=_.ssl,r.save(),this._oAuthHash=null,t(_)}else{const r=()=>{u?e._pendingDfd=this.oAuthSignIn(e.resUrl_,d,p,e.options_).then(t,s):(f=new a(\"identity-manager:not-authenticated\",\"User is not signed in.\"),s(f))};this._doPortalSignIn(e.resUrl_)?e._pendingDfd=this._getPlatformSelf(d.server,p.appId).then((({portalUrl:e,token:s,username:i})=>{!e||l(e,window.location.origin,!0)?(_=new q({server:d.server,userId:i,token:s}),t(_)):r()})).catch(r):r()}}else if(u){if(this._checkProtocol(e.resUrl_,d,s,e.admin_)){let r=e.options_;e.admin_&&(r=r||{},r.isAdmin=!0),e._pendingDfd=this.signIn(e.resUrl_,d,r).then(t,s)}}else f=new a(\"identity-manager:not-authenticated\",\"User is not signed in.\"),s(f)},o=()=>{const r=e.sinfo_,i=r.owningSystemUrl,o=e.options_;let n,a,h,l;if(o&&(n=o.token,a=o.error,h=o.prompt),l=this._findCredential(i,{token:n,resource:e.resUrl_}),!l)for(const e of this.credentials)if(this._isIdProvider(i,e.server)){l=e;break}if(l){const i=this.findCredential(e.resUrl_,l.userId);if(i)t(i);else if(P(r,this._legacyFed)){const e=l.toJSON();e.server=r.server,e.resources=null,t(new q(e))}else{(e._pendingDfd=this.generateToken(this.findServerInfo(l.server),null,{serverUrl:e.resUrl_,token:l.token,signal:e.options_.signal,ssl:l.ssl})).then((s=>{t(new q({userId:l.userId,server:r.server,token:s.token,expires:null!=s.expires?Number(s.expires):null,ssl:!!s.ssl,isAdmin:e.admin_,validity:s.validity}))}),s)}}else{this._busy=null,n&&(e.options_.token=null);(e._pendingDfd=this.getCredential(i.replace(/\\/?$/,\"/sharing\"),{resource:e.resUrl_,owningTenant:r.owningTenant,signal:e.options_.signal,token:n,error:a,prompt:h})).then((()=>{this._enqueue(e.resUrl_,e.sinfo_,e.options_,e,e.admin_)}),(e=>{s(e)}))}};this._errbackFunc=s;const n=e.sinfo_.owningSystemUrl,h=this._isServerRsrc(e.resUrl_),c=e.sinfo_._restInfoPms;c?c.promise.then((t=>{const s=e.sinfo_;if(s._restInfoPms){s.adminTokenServiceUrl=s._restInfoPms.adminUrl,s._restInfoPms=null,s.tokenServiceUrl=r(\"authInfo.tokenServicesUrl\",t)||r(\"authInfo.tokenServiceUrl\",t)||r(\"tokenServiceUrl\",t),s.shortLivedTokenValidity=r(\"authInfo.shortLivedTokenValidity\",t),s.currentVersion=t.currentVersion,s.owningTenant=t.owningTenant;const e=s.owningSystemUrl=t.owningSystemUrl;e&&this._portals.push(e)}h&&s.owningSystemUrl?o():i()}),(()=>{e.sinfo_._restInfoPms=null;const t=new a(\"identity-manager:server-identification-failed\",\"Unknown resource - could not find token service endpoint.\");s(t)})):h&&n?o():e.sinfo_._selfReq?e.sinfo_._selfReq.selfDfd.then((t=>{const s={};let r,i,o,n;return t&&(r=t.user&&t.user.username,s.username=r,s.allSSL=t.allSSL,i=t.supportsOAuth,o=t.currentVersion,\"multitenant\"===t.portalMode&&(n=t.customBaseUrl)),e.sinfo_.webTierAuth=!!r,r&&this.normalizeWebTierAuth?this.generateToken(e.sinfo_,null,{ssl:s.allSSL}).catch((()=>null)).then((e=>(s.portalToken=e&&e.token,s.tokenExpiration=e&&e.expires,s))):!r&&i&&parseFloat(o)>=4.4&&!this._findOAuthInfo(e.resUrl_)?this._generateOAuthInfo({portalUrl:e.sinfo_.server,customBaseUrl:n,owningTenant:e.sinfo_._selfReq.owningTenant}).catch((()=>null)).then((()=>s)):s})).catch((()=>null)).then((t=>{e.sinfo_._selfReq=null,t?i(t.username,t.allSSL,t.portalToken,t.tokenExpiration):i()})):i()}_generateOAuthInfo(e){let t,s,r=e.portalUrl;const i=e.customBaseUrl,o=e.owningTenant,n=!this.defaultOAuthInfo&&this._createDefaultOAuthInfo&&!this._hasTestedIfAppIsOnPortal;if(n){s=window.location.href;let e=s.indexOf(\"?\");e>-1&&(s=s.slice(0,e)),e=s.search(/\\/(apps|home)\\//),s=e>-1?s.slice(0,e):null}return n&&s?(this._hasTestedIfAppIsOnPortal=!0,t=A(s+\"/sharing/rest\",{query:{f:\"json\"}}).then((()=>{this.defaultOAuthInfo=new T({appId:\"arcgisonline\",popupCallbackUrl:s+\"/home/oauth-callback.html\"})}))):t=Promise.resolve(),t.then((()=>{if(this.defaultOAuthInfo)return r=r.replace(/^http:/i,\"https:\"),A(r+\"/sharing/rest/oauth2/validateRedirectUri\",{query:{accountId:o,client_id:this.defaultOAuthInfo.appId,redirect_uri:_(this.defaultOAuthInfo.popupCallbackUrl),f:\"json\"}}).then((e=>{if(e.data.valid){const t=this.defaultOAuthInfo.clone();e.data.urlKey&&i?t.portalUrl=\"https://\"+e.data.urlKey.toLowerCase()+\".\"+i:t.portalUrl=r,t.popup=window!==window.top||!(l(r,window.location.origin)||this._gwDomains.some((e=>e.regex.test(r)&&e.regex.test(window.location.origin)))),this.oAuthInfos.push(t)}}))}))}_doOAuthSignIn(e,s,r){const i={portalUrl:r.portalUrl};!r.popup&&r.preserveUrlHash&&window.location.hash&&(i.hash=window.location.hash);const o={client_id:r.appId,response_type:\"token\",state:JSON.stringify(i),expiration:r.expiration,locale:r.locale,redirect_uri:r.popup?_(r.popupCallbackUrl):window.location.href.replace(/#.*$/,\"\")};r.forceLogin&&(o.force_login=!0),r.forceUserId&&r.userId&&(o.prepopulatedusername=r.userId),!r.popup&&this._doPortalSignIn(e)&&(o.redirectToUserOrgUrl=!0);const n=r.portalUrl.replace(/^http:/i,\"https:\")+\"/sharing/oauth2/authorize\",h=n+\"?\"+f(o);if(r.popup){const e=window.open(h,\"esriJSAPIOAuth\",r.popupWindowFeatures);if(e)e.focus(),this._oAuthDfd.oAuthWin_=e,this._oAuthIntervalId=setInterval((()=>{if(e.closed){clearInterval(this._oAuthIntervalId),this._oAuthOnHashHandle.remove();const e=this._oAuthDfd;if(e){const t=new a(\"identity-manager:user-aborted\",\"ABORTED\");e.reject(t)}}}),500),this._oAuthOnHashHandle=g(t,\"arcgis:auth:hash\",(e=>{this.setOAuthResponseHash(e.detail)}));else{const e=new a(\"identity-manager:popup-blocked\",\"ABORTED\");this._oAuthDfd.reject(e)}}else this._rejectOnPersistedPageShow=!0,this._oAuthRedirectFunc?this._oAuthRedirectFunc({authorizeParams:o,authorizeUrl:n,resourceUrl:e,serverInfo:s,oAuthInfo:r}):window.location.href=h}};j=e([n(\"esri.identity.IdentityManagerBase\")],j);let q=class extends I.EventedAccessor{constructor(e){super(e),this._oAuthCred=null,this.tokenRefreshBuffer=2,e&&e._oAuthCred&&(this._oAuthCred=e._oAuthCred)}initialize(){this.resources=this.resources||[],null==this.creationTime&&(this.creationTime=Date.now())}refreshToken(){const e=k.findServerInfo(this.server),t=e&&e.owningSystemUrl,s=!!t&&\"server\"===this.scope,r=s&&P(e,k._legacyFed),i=e.webTierAuth,o=i&&k.normalizeWebTierAuth,n=R[this.server],a=n&&n[this.userId];let h,l=this.resources&&this.resources[0],c=s&&k.findServerInfo(t),d={username:this.userId,password:a};if(i&&!o)return;s&&!c&&k.serverInfos.some((e=>(k._isIdProvider(t,e.server)&&(c=e),!!c)));const u=c&&k.findCredential(c.server,this.userId);if(!s||u){if(!r){if(s)h={serverUrl:l,token:u&&u.token,ssl:u&&u.ssl};else if(o)d=null,h={ssl:this.ssl};else{if(!a){let t;return l&&(l=k._sanitizeUrl(l),this._enqueued=1,t=k._enqueue(l,e,null,null,this.isAdmin,this),t.then((()=>{this._enqueued=0,this.refreshServerTokens()})).catch((()=>{this._enqueued=0}))),t}this.isAdmin&&(h={isAdmin:!0})}return k.generateToken(s?c:e,s?null:d,h).then((e=>{this.token=e.token,this.expires=null!=e.expires?Number(e.expires):null,this.creationTime=Date.now(),this.validity=e.validity,this.emitTokenChange(),this.refreshServerTokens()})).catch((()=>{}))}u.refreshToken()}}refreshServerTokens(){\"portal\"===this.scope&&k.credentials.forEach((e=>{const t=k.findServerInfo(e.server),s=t&&t.owningSystemUrl;e!==this&&e.userId===this.userId&&s&&\"server\"===e.scope&&(k._hasSameServerInstance(this.server,s)||k._isIdProvider(s,this.server))&&(P(t,k._legacyFed)?(e.token=this.token,e.expires=this.expires,e.creationTime=this.creationTime,e.validity=this.validity,e.emitTokenChange()):e.refreshToken())}))}emitTokenChange(e){clearTimeout(this._refreshTimer);const t=this.server&&k.findServerInfo(this.server),s=t&&t.owningSystemUrl,r=s&&k.findServerInfo(s);!1===e||s&&\"portal\"!==this.scope&&(!r||!r.webTierAuth||k.normalizeWebTierAuth)||null==this.expires&&null==this.validity||this._startRefreshTimer(),this.emit(\"token-change\")}destroy(){this.userId=this.server=this.token=this.expires=this.validity=this.resources=this.creationTime=null,this._oAuthCred&&(this._oAuthCred.destroy(),this._oAuthCred=null);const e=k.credentials.indexOf(this);e>-1&&k.credentials.splice(e,1),this.emitTokenChange(),this.emit(\"destroy\")}toJSON(){const e=s({userId:this.userId,server:this.server,token:this.token,expires:this.expires,validity:this.validity,ssl:this.ssl,isAdmin:this.isAdmin,creationTime:this.creationTime,scope:this.scope}),t=this.resources;return t&&t.length>0&&(e.resources=t.slice()),e}_startRefreshTimer(){clearTimeout(this._refreshTimer);const e=6e4*this.tokenRefreshBuffer,t=2**31-1;let s=(this.validity?this.creationTime+6e4*this.validity:this.expires)-Date.now();s<0?s=0:s>t&&(s=t),this._refreshTimer=setTimeout(this.refreshToken.bind(this),s>e?s-e:s)}};e([o()],q.prototype,\"creationTime\",void 0),e([o()],q.prototype,\"expires\",void 0),e([o()],q.prototype,\"isAdmin\",void 0),e([o()],q.prototype,\"oAuthState\",void 0),e([o()],q.prototype,\"resources\",void 0),e([o()],q.prototype,\"scope\",void 0),e([o()],q.prototype,\"server\",void 0),e([o()],q.prototype,\"ssl\",void 0),e([o()],q.prototype,\"token\",void 0),e([o()],q.prototype,\"tokenRefreshBuffer\",void 0),e([o()],q.prototype,\"userId\",void 0),e([o()],q.prototype,\"validity\",void 0),q=e([n(\"esri.identity.Credential\")],q);export{q as Credential,j as IdentityManagerBase};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as s}from\"../chunks/tslib.es6.js\";import{subclass as e}from\"../core/accessorSupport/decorators/subclass.js\";import{setId as r}from\"../kernel.js\";import{IdentityManagerBase as t}from\"./IdentityManagerBase.js\";let o=class extends t{};o=s([e(\"esri.identity.IdentityManager\")],o);const a=new o;r(a);export default a;\n"],"sourceRoot":""}