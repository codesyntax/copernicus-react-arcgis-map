{"version":3,"sources":["../node_modules/@arcgis/core/core/CircularArray.js","../node_modules/@arcgis/core/views/2d/layers/features/FeatureStore2D.js","../node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderPBFIndirect.js","../node_modules/@arcgis/core/views/2d/arcade/callExpressionWithCursor.js","../node_modules/@arcgis/core/views/2d/layers/features/Store2D.js"],"names":["s","t","Number","POSITIVE_INFINITY","this","size","_start","maxSize","_buffer","isFinite","Array","i","dequeue","h","e","c","I","u","getObjectId","getAttributes","readAttributes","getAttribute","readAttribute","cloneWithGeometry","getGeometry","readHydratedGeometry","getCentroid","readCentroid","l","featureAdapter","events","a","_featureSetsByInstance","Map","_objectIdToDisplayId","_spatialIndexInvalid","_indexSearchCache","r","_index","minX","_storage","getXMin","minY","getYMin","maxX","getXMax","maxY","getYMax","mode","featureCount","vertexCount","has","addOrUpdate","attachStorage","getCursor","next","getDisplayId","setComputedAttributes","scale","set","instance","_insertFeature","emit","_rebuildIndex","id","find","tileId","readers","n","_searchIndex","bounds","getInstanceId","get","push","forEach","d","from","enqueue","getIndex","createDisplayId","setDisplayId","setInstanceId","delete","releaseDisplayId","removeAtIndex","isEmpty","_lookupFeature","_getFeatureSet","setIndex","lookupFeatureByDisplayId","readGeometry","unsetAttributeData","search","setBounds","clear","load","o","createInstance","_currentIndex","_reader","_indices","length","copy","_nextIndex","_passesFilter","_getExists","setArcadeSpatialReference","geometryType","hasFeatures","exceededTransferLimit","hasZ","hasM","getStorage","getComputedNumericAtIndex","setComputedNumericAtIndex","getComputedStringAtIndex","setComputedStringAtIndex","transform","extent","hasFilter","joinAttributes","readArcadeFeature","geometry","hasField","setField","keys","castToText","getQuantizationTransform","getAttributeHash","getGroupId","setGroupId","getXHydrate","getYHydrate","getX","getY","readLegacyFeature","readOptimizedFeature","readLegacyPointGeometry","readLegacyGeometry","readLegacyCentroid","readGeometryArea","readUnquantizedGeometry","Error","referencesGeometry","evaluate","$feature","getLogger","warn","_canCacheExpressionValue","_sourceInfo","_bitsets","computed","getBitset","createBitset","_schema","console","debug","targets","name","attributes","p","type","_createArcadeComputedField","_createLabelArcadeComputedField","Promise","all","_computedFields","some","expression","referencesScale","_statisticFields","_evaluateField","resultType","fieldIndex","spatialReference","fieldsIndex","valueExpression","fields","createLabelFunction","label","builder","$view"],"mappings":"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","file":"static/js/28.5794a981.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{isSome as t}from\"./maybe.js\";class s{constructor(t=Number.POSITIVE_INFINITY){this.size=0,this._start=0,this.maxSize=t,this._buffer=isFinite(t)?new Array(t):[]}get entries(){return this._buffer}enqueue(t){if(this.size===this.maxSize){const s=this._buffer[this._start];return this._buffer[this._start]=t,this._start=(this._start+1)%this.maxSize,s}return isFinite(this.maxSize)?this._buffer[(this._start+this.size++)%this.maxSize]=t:this._buffer[this._start+this.size++]=t,null}dequeue(){if(0===this.size)return null;const t=this._buffer[this._start];return this._buffer[this._start]=null,this.size--,this._start=(this._start+1)%this.maxSize,t}peek(){return 0===this.size?null:this._buffer[this._start]}find(s){if(0===this.size)return null;for(const i of this._buffer)if(t(i)&&s(i))return i;return null}clear(s){let i=this.dequeue();for(;t(i);)s&&s(i),i=this.dequeue()}}export default s;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport\"../../../../core/has.js\";import{isNone as t,isSome as e,unwrap as s}from\"../../../../core/maybe.js\";import a from\"../../../../core/Evented.js\";import r from\"../../../../core/CircularArray.js\";import{fromRect as n}from\"../../../../geometry/support/aaBoundingBox.js\";import{r as i}from\"../../../../chunks/rbush.js\";import{Store2D as o}from\"./Store2D.js\";import{FeatureSetReaderIndirect as d}from\"./support/FeatureSetReaderPBFIndirect.js\";function h(t,e){return t<<16|e}function c(t){return(4294901760&t)>>>16}function I(t){return 65535&t}const u={getObjectId:t=>t.getObjectId(),getAttributes:t=>t.readAttributes(),getAttribute:(t,e)=>t.readAttribute(e),cloneWithGeometry:(t,e)=>t,getGeometry:t=>t.readHydratedGeometry(),getCentroid:(t,e)=>t.readCentroid()};class l extends o{constructor(t,e,s){super(t,e),this.featureAdapter=u,this.events=new a,this._featureSetsByInstance=new Map,this._objectIdToDisplayId=new Map,this._spatialIndexInvalid=!0,this._indexSearchCache=new r(50),this._index=i(9,(t=>({minX:this._storage.getXMin(t),minY:this._storage.getYMin(t),maxX:this._storage.getXMax(t),maxY:this._storage.getYMax(t)}))),this._storage=e,this.mode=s}get storage(){return this._storage}get storeStatistics(){return{featureCount:0,vertexCount:0}}hasInstance(t){return this._featureSetsByInstance.has(t)}onTileData(e,s){if(t(s.addOrUpdate))return s;if(s.addOrUpdate.attachStorage(this._storage),\"snapshot\"===this.mode){const t=s.addOrUpdate.getCursor();for(;t.next();){const s=t.getDisplayId();this.setComputedAttributes(this._storage,t,s,e.scale)}return s}this._featureSetsByInstance.set(s.addOrUpdate.instance,s.addOrUpdate);const a=s.addOrUpdate.getCursor();for(;a.next();)this._insertFeature(a,e.scale);return this._spatialIndexInvalid=!0,this.events.emit(\"changed\"),s}search(t){this._rebuildIndex();const s=t.id,a=this._indexSearchCache.find((t=>t.tileId===s));if(e(a))return a.readers;const r=new Map,n=this._searchIndex(t.bounds),i=[];for(const e of n){const t=this._storage.getInstanceId(e),s=c(t),a=I(t);r.has(s)||r.set(s,[]);r.get(s).push(a)}return r.forEach(((t,e)=>{const s=this._featureSetsByInstance.get(e);i.push(d.from(s,t))})),this._indexSearchCache.enqueue({tileId:s,readers:i}),i}insert(t){const e=t.getCursor(),s=this._storage;for(;e.next();){var a;const t=h(e.instance,e.getIndex()),r=e.getObjectId(),n=null!=(a=this._objectIdToDisplayId.get(r))?a:this._storage.createDisplayId();e.setDisplayId(n),s.setInstanceId(n,t),this._objectIdToDisplayId.set(r,n)}this._featureSetsByInstance.set(t.instance,t),this._spatialIndexInvalid=!0}remove(t){const e=this._objectIdToDisplayId.get(t);if(!e)return;const s=this._storage.getInstanceId(e),a=I(s),r=c(s),n=this._featureSetsByInstance.get(r);this._objectIdToDisplayId.delete(t),this._storage.releaseDisplayId(e),n.removeAtIndex(a),n.isEmpty&&this._featureSetsByInstance.delete(r),this._spatialIndexInvalid=!0}forEach(t){this._objectIdToDisplayId.forEach((e=>{const s=this._storage.getInstanceId(e),a=this._lookupFeature(s);t(a)}))}forEachUnsafe(t){this._objectIdToDisplayId.forEach((e=>{const s=this._storage.getInstanceId(e),a=c(s),r=I(s),n=this._getFeatureSet(a);n.setIndex(r),t(n)}))}forEachInBounds(t,e){const a=this._searchIndex(t);for(const r of a){const t=this.lookupFeatureByDisplayId(r,this._storage);e(s(t))}}forEachBounds(t,e,s){this._rebuildIndex();const a=[0,0,0,0];for(const r of t){if(!r.readGeometry())continue;const t=r.getDisplayId();a[0]=this._storage.getXMin(t),a[1]=this._storage.getYMin(t),a[2]=this._storage.getXMax(t),a[3]=this._storage.getYMax(t),e(n(s,a))}}sweepFeatures(t,e,s){this._spatialIndexInvalid=!0,this._objectIdToDisplayId.forEach(((a,r)=>{t.has(a)||(e.releaseDisplayId(a),s&&s.unsetAttributeData(a),this._objectIdToDisplayId.delete(r))})),this.events.emit(\"changed\")}sweepFeatureSets(t){this._spatialIndexInvalid=!0,this._featureSetsByInstance.forEach(((e,s)=>{t.has(s)||this._featureSetsByInstance.delete(s)}))}lookupObjectId(e,s){const a=this.lookupFeatureByDisplayId(e,s);return t(a)?null:a.getObjectId()}lookupDisplayId(t){return this._objectIdToDisplayId.get(t)}lookupFeatureByDisplayId(t,e){const s=e.getInstanceId(t);return this._lookupFeature(s)}lookupByDisplayIdUnsafe(t){const e=this._storage.getInstanceId(t),s=c(e),a=I(e),r=this._getFeatureSet(s);return r?(r.setIndex(a),r):null}_insertFeature(t,e){const s=this._storage,a=t.getObjectId(),r=h(t.instance,t.getIndex());s.getInstanceId(t.getDisplayId());let n=this._objectIdToDisplayId.get(a);n||(n=s.createDisplayId(),this._objectIdToDisplayId.set(a,n),this._spatialIndexInvalid=!0),t.setDisplayId(n),s.setInstanceId(n,r),this.setComputedAttributes(s,t,n,e)}_searchIndex(t){this._rebuildIndex();const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this._index.search(e)}_rebuildIndex(){if(!this._spatialIndexInvalid)return;const t=[];\"snapshot\"===this.mode?this._featureSetsByInstance.forEach((e=>{const s=e.getCursor();for(;s.next();){const e=s.getDisplayId();this._storage.setBounds(e,s)&&t.push(e)}})):this._objectIdToDisplayId.forEach((e=>{const s=this._storage.getInstanceId(e);this._storage.setBounds(e,this._lookupFeature(s))&&t.push(e)})),this._index.clear(),this._index.load(t),this._indexSearchCache.clear(),this._spatialIndexInvalid=!1}_lookupFeature(t){const e=c(t),s=I(t),a=this._getFeatureSet(e);if(!a)return null;const r=a.getCursor();return r.setIndex(s),r}_getFeatureSet(t){return this._featureSetsByInstance.get(t)}}export{l as FeatureStore2D,u as featureAdapter};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{FeatureSetReader as e}from\"./FeatureSetReader.js\";class r extends e{constructor(r,t){super(e.createInstance()),this._currentIndex=-1,this._reader=r,this._indices=t}static from(e,t){return new r(e.copy(),t)}get hasNext(){return this._currentIndex+1<this._indices.length}getApproximateSize(){return this._indices.length}getCursor(){return this.copy()}copy(){const e=new r(this._reader.copy(),this._indices);return e._currentIndex=this._currentIndex,e}next(){for(;this._nextIndex()&&!this._reader._passesFilter()&&!this._reader._getExists(););return this._currentIndex<this._indices.length}_nextIndex(){return++this._currentIndex<this._indices.length&&(this._reader.setIndex(this._indices[this._currentIndex]),!0)}setArcadeSpatialReference(e){this._reader.setArcadeSpatialReference(e)}attachStorage(e){this._reader.attachStorage(e)}get geometryType(){return this._reader.geometryType}get hasFeatures(){return this._reader.hasFeatures}get exceededTransferLimit(){return this._reader.exceededTransferLimit}get hasZ(){return this._reader.hasZ}get hasM(){return this._reader.hasM}getStorage(){return this._reader.getStorage()}getComputedNumeric(e){return this._reader.getComputedNumericAtIndex(0)}setComputedNumeric(e,r){return this._reader.setComputedNumericAtIndex(r,0)}getComputedString(e){return this._reader.getComputedStringAtIndex(0)}setComputedString(e,r){return this._reader.setComputedStringAtIndex(0,r)}getComputedNumericAtIndex(e){return this._reader.getComputedNumericAtIndex(e)}setComputedNumericAtIndex(e,r){this._reader.setComputedNumericAtIndex(e,r)}getComputedStringAtIndex(e){return this._reader.getComputedStringAtIndex(e)}setComputedStringAtIndex(e,r){return this._reader.setComputedStringAtIndex(e,r)}transform(e,r,t,d){const a=this.copy();return a._reader=this._reader.transform(e,r,t,d),a}extent(e,r,t,d){const a=this.copy();return a._reader=this._reader.extent(e,r,t,d),a}hasFilter(){return this._reader.hasFilter()}readAttribute(e,r=!1){return this._reader.readAttribute(e,r)}readAttributes(){return this._reader.readAttributes()}joinAttributes(e){return this._reader.joinAttributes(e)}readArcadeFeature(){return this._reader.readArcadeFeature()}geometry(){return this._reader.geometry()}field(e){return this.readAttribute(e,!0)}hasField(e){return this._reader.hasField(e)}setField(e,r){return this._reader.setField(e,r)}keys(){return this._reader.keys()}castToText(){return this._reader.castToText()}getQuantizationTransform(){return this._reader.getQuantizationTransform()}getAttributeHash(){return this._reader.getAttributeHash()}getObjectId(){return this._reader.getObjectId()}getDisplayId(){return this._reader.getDisplayId()}setDisplayId(e){return this._reader.setDisplayId(e)}getGroupId(){return this._reader.getGroupId()}setGroupId(e){return this._reader.setGroupId(e)}getXHydrate(){return this._reader.getXHydrate()}getYHydrate(){return this._reader.getYHydrate()}getX(){return this._reader.getX()}getY(){return this._reader.getY()}setIndex(e){return this._reader.setIndex(e)}getIndex(){return this._reader.getIndex()}readLegacyFeature(){return this._reader.readLegacyFeature()}readOptimizedFeature(){return this._reader.readOptimizedFeature()}readLegacyPointGeometry(){return this._reader.readLegacyPointGeometry()}readLegacyGeometry(){return this._reader.readLegacyGeometry()}readLegacyCentroid(){return this._reader.readLegacyCentroid()}readGeometryArea(){return this._reader.readGeometryArea()}readUnquantizedGeometry(){return this._reader.readUnquantizedGeometry()}readHydratedGeometry(){return this._reader.readHydratedGeometry()}readGeometry(){return this._reader.readGeometry()}readCentroid(){return this._reader.readCentroid()}_passesFilter(){return this._reader._passesFilter()}_readAttribute(e,r){throw new Error(\"Error: Should not be called. Underlying _reader should be used instead\")}_readAttributes(){throw new Error(\"Error: Should not be called. Underlying _reader should be used instead\")}}export{r as FeatureSetReaderIndirect};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport e from\"../../../core/Logger.js\";function r(r,a,t){r.referencesGeometry();const n=a.readArcadeFeature();try{return r.evaluate({...t,$feature:n})}catch(o){return e.getLogger(\"esri.views.2d.support.arcadeOnDemand\").warn(\"Feature arcade evaluation failed:\",o),null}}export default r;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/has.js\";import{isNone as s}from\"../../../../core/maybe.js\";import{createRendererExpression as t}from\"../../../../support/arcadeOnDemand.js\";import{diff as i,hasDiff as a}from\"../../../../core/accessorSupport/diffUtils.js\";import r from\"../../arcade/callExpressionWithCursor.js\";const c=import(\"../../../../layers/support/labelFormatUtils.js\");class o{constructor(e,s){this._canCacheExpressionValue=!1,this._sourceInfo=e,this._bitsets={computed:s.getBitset(s.createBitset())}}invalidate(){this._bitsets.computed.clear()}async updateSchema(t,r){const c=i(this._schema,r);if(this._schema=r,!r||s(c)||!a(c,\"attributes\"))return;e(\"esri-2d-update-debug\")&&console.debug(\"Applying Update - Store:\",c),this._bitsets.computed.clear(),t.targets[r.name]=!0;const o=r.attributes,n=[],p=[];for(const e in o){const s=o[e];switch(s.type){case\"field\":break;case\"expression\":n.push(this._createArcadeComputedField(s));break;case\"label-expression\":n.push(this._createLabelArcadeComputedField(s));break;case\"statistic\":p.push(s)}}this._computedFields=await Promise.all(n),this._canCacheExpressionValue=!this._computedFields.some((e=>\"expression\"===e.type&&e.expression.referencesScale())),this._statisticFields=p}setComputedAttributes(e,s,t,i){const a=this._bitsets.computed;if(!this._canCacheExpressionValue||!a.has(t)){a.set(t);for(const a of this._computedFields){const r=this._evaluateField(s,a,i);switch(a.resultType){case\"numeric\":e.setComputedNumericAtIndex(t,a.fieldIndex,r);break;case\"string\":e.setComputedStringAtIndex(t,a.fieldIndex,r)}}}}async _createArcadeComputedField(e){const s=this._sourceInfo.spatialReference,i=this._sourceInfo.fieldsIndex;return{...e,expression:await t(e.valueExpression,s,i)}}async _createLabelArcadeComputedField(e){const s=this._sourceInfo.spatialReference,t=this._sourceInfo.fields,{createLabelFunction:i}=await c,a=await i(e.label,t,s);return{...e,builder:a}}_evaluateField(e,s,t){switch(s.type){case\"label-expression\":{const t=e.readArcadeFeature();return s.builder.evaluate(t)||\"\"}case\"expression\":{const{expression:i}=s;return r(i,e,{$view:{scale:t}})}}}}export{o as Store2D};\n"],"sourceRoot":""}