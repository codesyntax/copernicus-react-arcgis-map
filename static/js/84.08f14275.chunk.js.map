{"version":3,"sources":["../node_modules/@arcgis/core/layers/graphics/sources/support/clientSideDefaults.js","../node_modules/@arcgis/core/layers/graphics/sources/FeatureLayerSource.js"],"names":["i","t","renderer","type","symbol","e","n","o","s","r","indexOf","JSON","stringify","Function","u","name","description","prototype","attributes","b","a","l","data","Promise","FileReader","readAsDataURL","onload","result","onerror","F","Set","R","arguments","signal","this","addResolvingPromise","_fetchService","resolve","layer","capabilities","query","supportsFormatPBF","parsedUrl","dynamicDataSource","gdbVersion","spatialReference","fieldsIndex","f","url","path","format","sourceSpatialReference","load","objectIdField","_getLayerRequestOptions","_getFormDataForAttachment","c","body","_createFeatureEditResult","addAttachmentResult","_createAttachmentErrorResult","attachmentId","updateAttachmentResult","addFeatures","map","_serializeFeature","updateFeatures","_getFeatureIds","deleteFeatures","globalIdUsed","p","deleteAttachments","addAttachments","_serializeAttachment","push","updateAttachments","length","adds","updates","deletes","method","join","rollbackOnFailure","rollbackOnFailureEnabled","useGlobalIds","attachments","d","_createEditsResult","attachmentIds","deleteAttachmentResults","then","returnUpdates","layerId","id","extent","fullExtent","timeExtent","fromJSON","y","start","end","get","objectIds","all","parentObjectId","attachmentInfos","m","queryTask","executeAttachmentQuery","execute","customParameters","executeJSON","executeForIds","executeForCount","executeForExtent","executeRelationshipQuery","executeRelationshipQueryForCount","sourceJSON","returnAdvancedSymbols","_patchServiceJSON","has","geometryType","drawingInfo","defaultSymbol","g","geometry","toJSON","feature","attachment","globalId","contentType","uploadId","parentGlobalId","globalIdField","mediaType","File","_canUseGlobalIds","_getGlobalIdsFromFeatureIdentifier","_getObjectIdsFromFeatureIdentifier","_getIdsFromFeatures","objectId","addFeatureResults","addResults","updateFeatureResults","updateResults","deleteFeatureResults","deleteResults","addAttachmentResults","updateAttachmentResults","success","error","code","details","messages","message","httpStatus","messageCode","FormData","elements","set","append","source","responseType","h","constructOnly","readOnly","q"],"mappings":"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","file":"static/js/84.08f14275.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport t from\"../../../../core/has.js\";import{clone as r}from\"../../../../core/lang.js\";import{defaultPointSymbolJSON as e,defaultPolylineSymbolJSON as n,defaultPolygonSymbolJSON as o}from\"../../../../symbols/support/defaultsJSON.js\";function i(t){return{renderer:{type:\"simple\",symbol:\"esriGeometryPoint\"===t||\"esriGeometryMultipoint\"===t?e:\"esriGeometryPolyline\"===t?n:o}}}function s(r,e){if(t(\"csp-restrictions\"))return()=>({[e]:null,...r});try{let t=`this.${e} = null;`;for(const e in r){t+=`this${e.indexOf(\".\")?`[\"${e}\"]`:`.${e}`} = ${JSON.stringify(r[e])};`}const n=new Function(t);return()=>new n}catch(n){return()=>({[e]:null,...r})}}function u(t={}){return[{name:\"New Feature\",description:\"\",prototype:{attributes:r(t)}}]}export{s as createDefaultAttributesFunction,u as createDefaultTemplate,i as createDrawingInfo};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.19/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/has.js\";import{fixJson as r}from\"../../../core/lang.js\";import{setDeepValue as a}from\"../../../core/object.js\";import{isSome as s,isNone as o}from\"../../../core/maybe.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as u}from\"../../../core/accessorSupport/decorators/subclass.js\";import n from\"../../../core/Error.js\";import{dataComponents as l}from\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import d from\"../../../geometry/Extent.js\";import c from\"../../../request.js\";import h from\"../../../core/Loadable.js\";import y from\"../../../TimeExtent.js\";import{unapplyEditsZUnitScaling as p}from\"../../../rest/query/operations/zscale.js\";import{processAttachmentQueryResult as m}from\"../../../rest/query/operations/queryAttachments.js\";import f from\"../../../tasks/QueryTask.js\";import{createDrawingInfo as g}from\"./support/clientSideDefaults.js\";async function b(e){if(\"string\"==typeof e){const t=l(e);return t||{data:e}}return new Promise(((t,r)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>t(l(a.result)),a.onerror=e=>r(e)}))}const F=new Set([\"Feature Layer\",\"Table\"]);let R=class extends h{constructor(){super(...arguments),this.type=\"feature-layer\"}load(e){const t=s(e)?e.signal:null;return this.addResolvingPromise(this._fetchService(t)),Promise.resolve(this)}get queryTask(){const{capabilities:{query:{supportsFormatPBF:e}},parsedUrl:r,dynamicDataSource:a,gdbVersion:s,spatialReference:o,fieldsIndex:i}=this.layer,u=t(\"featurelayer-pbf\")&&e?\"pbf\":\"json\";return new f({url:r.path,format:u,fieldsIndex:i,dynamicDataSource:a,gdbVersion:s,sourceSpatialReference:o})}async addAttachment(e,t){await this.load();const r=e.attributes[this.layer.objectIdField],a=this.layer.parsedUrl.path+\"/\"+r+\"/addAttachment\",s=this._getLayerRequestOptions(),o=this._getFormDataForAttachment(t,s.query);try{const e=await c(a,{body:o});return this._createFeatureEditResult(e.data.addAttachmentResult)}catch(i){throw this._createAttachmentErrorResult(r,i)}}async updateAttachment(e,t,r){await this.load();const a=e.attributes[this.layer.objectIdField],s=this.layer.parsedUrl.path+\"/\"+a+\"/updateAttachment\",o=this._getLayerRequestOptions({query:{attachmentId:t}}),i=this._getFormDataForAttachment(r,o.query);try{const e=await c(s,{body:i});return this._createFeatureEditResult(e.data.updateAttachmentResult)}catch(u){throw this._createAttachmentErrorResult(a,u)}}async applyEdits(e,t){await this.load();const r=e.addFeatures.map(this._serializeFeature,this),a=e.updateFeatures.map(this._serializeFeature,this),s=this._getFeatureIds(e.deleteFeatures,null==t?void 0:t.globalIdUsed);p(r,a,this.layer.spatialReference);const o=[],i=[],u=[...e.deleteAttachments];for(const c of e.addAttachments)o.push(await this._serializeAttachment(c));for(const c of e.updateAttachments)i.push(await this._serializeAttachment(c));const n=o.length||i.length||u.length?{adds:o,updates:i,deletes:u}:null,l=this._getLayerRequestOptions({method:\"post\",query:{adds:r.length?JSON.stringify(r):null,updates:a.length?JSON.stringify(a):null,deletes:s.length?null!=t&&t.globalIdUsed?JSON.stringify(s):s.join(\",\"):null,gdbVersion:(null==t?void 0:t.gdbVersion)||this.layer.gdbVersion,rollbackOnFailure:null==t?void 0:t.rollbackOnFailureEnabled,useGlobalIds:null==t?void 0:t.globalIdUsed,attachments:n&&JSON.stringify(n)}}),d=await c(this.layer.parsedUrl.path+\"/applyEdits\",l);return this._createEditsResult(d)}async deleteAttachments(e,t){await this.load();const r=e.attributes[this.layer.objectIdField],a=this.layer.parsedUrl.path+\"/\"+r+\"/deleteAttachments\";try{return(await c(a,this._getLayerRequestOptions({query:{attachmentIds:t.join(\",\")},method:\"post\"}))).data.deleteAttachmentResults.map(this._createFeatureEditResult)}catch(s){throw this._createAttachmentErrorResult(r,s)}}fetchRecomputedExtents(e={}){const t=e.signal;return this.load({signal:t}).then((async()=>{const t=this._getLayerRequestOptions({...e,query:{returnUpdates:!0}}),{layerId:r,url:a}=this.layer,{data:s}=await c(`${a}/${r}`,t),{id:o,extent:i,fullExtent:u,timeExtent:n}=s,l=i||u;return{id:o,fullExtent:l&&d.fromJSON(l),timeExtent:n&&y.fromJSON({start:n[0],end:n[1]})}}))}async queryAttachments(e,t={}){const{parsedUrl:r}=this.layer,a=r.path;await this.load();const s=this._getLayerRequestOptions(t);if(!this.layer.get(\"capabilities.operations.supportsQueryAttachments\")){const{objectIds:t}=e,r=[];for(const e of t){const t=a+\"/\"+e+\"/attachments\";r.push(c(t,s))}return Promise.all(r).then((e=>t.map(((t,r)=>({parentObjectId:t,attachmentInfos:e[r].data.attachmentInfos}))))).then((e=>m(e,a)))}return this.queryTask.executeAttachmentQuery(e,s)}async queryFeatures(e,t){return await this.load(),this.queryTask.execute(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryFeaturesJSON(e,t){return await this.load(),this.queryTask.executeJSON(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryObjectIds(e,t){return await this.load(),this.queryTask.executeForIds(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryFeatureCount(e,t){return await this.load(),this.queryTask.executeForCount(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryExtent(e,t){return await this.load(),this.queryTask.executeForExtent(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryRelatedFeatures(e,t){return await this.load(),this.queryTask.executeRelationshipQuery(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryRelatedFeaturesCount(e,t){return await this.load(),this.queryTask.executeRelationshipQueryForCount(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async _fetchService(e){let r=this.layer.sourceJSON;if(!r){const{data:a}=await c(this.layer.parsedUrl.path,this._getLayerRequestOptions({query:t(\"featurelayer-advanced-symbols\")?{returnAdvancedSymbols:!0}:{},signal:e}));r=a}this.sourceJSON=this._patchServiceJSON(r);const a=r.type;if(!F.has(a))throw new n(\"feature-layer-source:unsupported-type\",`Source type \"${a}\" is not supported`)}_patchServiceJSON(e){var t;if(\"Table\"!==e.type&&e.geometryType&&(null==e||null==(t=e.drawingInfo)||!t.renderer)&&!e.defaultSymbol){const t=g(e.geometryType).renderer;a(\"drawingInfo.renderer\",t,e)}return e}_serializeFeature(e){const{geometry:t,attributes:r}=e;return o(t)?{attributes:r}:\"mesh\"===t.type||\"extent\"===t.type?null:{geometry:t.toJSON(),attributes:r}}async _serializeAttachment(e){const{feature:t,attachment:r}=e,{globalId:a,name:s,contentType:o,data:i,uploadId:u}=r,n={globalId:a,parentGlobalId:null,contentType:null,name:null,uploadId:null,data:null};if(t&&(n.parentGlobalId=\"attributes\"in t?t.attributes&&t.attributes[this.layer.globalIdField]:t.globalId),u)n.uploadId=u;else if(i){const e=await b(i);n.contentType=e.mediaType,n.data=e.data,i instanceof File&&(n.name=i.name)}return s&&(n.name=s),o&&(n.contentType=o),n}_getFeatureIds(e,t){const r=e[0];return r?this._canUseGlobalIds(t,e)?this._getGlobalIdsFromFeatureIdentifier(e):\"objectId\"in r?this._getObjectIdsFromFeatureIdentifier(e):this._getIdsFromFeatures(e):[]}_getIdsFromFeatures(e){const t=this.layer.objectIdField;return e.map((e=>e.attributes&&e.attributes[t]))}_canUseGlobalIds(e,t){return e&&\"globalId\"in t[0]}_getObjectIdsFromFeatureIdentifier(e){return e.map((e=>e.objectId))}_getGlobalIdsFromFeatureIdentifier(e){return e.map((e=>e.globalId))}_createEditsResult(e){const t=e.data,r=e.data&&e.data.attachments;return{addFeatureResults:t.addResults?t.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:t.updateResults?t.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:t.deleteResults?t.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:r&&r.addResults?r.addResults.map(this._createFeatureEditResult,this):[],updateAttachmentResults:r&&r.updateResults?r.updateResults.map(this._createFeatureEditResult,this):[],deleteAttachmentResults:r&&r.deleteResults?r.deleteResults.map(this._createFeatureEditResult,this):[]}}_createFeatureEditResult(e){const t=!0===e.success?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:t?new n(\"feature-layer-source:edit-failure\",t.description,{code:t.code}):null}}_createAttachmentErrorResult(e,t){const r=t.details.messages&&t.details.messages[0]||t.message,a=t.details.httpStatus||t.details.messageCode;return{objectId:e,globalId:null,error:new n(\"feature-layer-source:attachment-failure\",r,{code:a})}}_getFormDataForAttachment(e,t){const r=e instanceof FormData?e:e&&e.elements?new FormData(e):null;if(r)for(const a in t){const e=t[a];null!=e&&(r.set?r.set(a,e):r.append(a,e))}return r}_getLayerRequestOptions(e={}){const{parsedUrl:t,gdbVersion:a,dynamicDataSource:s}=this.layer;return{...e,query:r({gdbVersion:a,layer:s?JSON.stringify({source:s}):void 0,...t.query,f:\"json\",...this.layer.customParameters,...null==e?void 0:e.query}),responseType:\"json\"}}};e([i()],R.prototype,\"type\",void 0),e([i({constructOnly:!0})],R.prototype,\"layer\",void 0),e([i({readOnly:!0})],R.prototype,\"queryTask\",null),R=e([u(\"esri.layers.graphics.sources.FeatureLayerSource\")],R);var q=R;export default q;\n"],"sourceRoot":""}